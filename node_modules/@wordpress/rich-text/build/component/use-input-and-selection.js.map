{"version":3,"names":["_element","require","_compose","_getActiveFormats","_updateFormats","INSERTION_INPUT_TYPES_TO_IGNORE","Set","EMPTY_ACTIVE_FORMATS","PLACEHOLDER_ATTR_NAME","fixPlaceholderSelection","defaultView","selection","getSelection","anchorNode","anchorOffset","nodeType","ELEMENT_NODE","targetNode","childNodes","hasAttribute","collapseToStart","useInputAndSelection","props","propsRef","useRef","current","useRefEffect","element","ownerDocument","isComposing","onInput","event","inputType","record","applyRecord","createRecord","handleChange","indexOf","has","currentValue","start","activeFormats","oldActiveFormats","change","updateFormats","value","end","formats","handleSelectionChange","onSelectionChange","contentEditable","activeElement","contains","focusNode","offset","undefined","text","oldRecord","length","newValue","_newActiveFormats","newActiveFormats","getActiveFormats","domOnly","onCompositionStart","removeEventListener","querySelector","remove","onCompositionEnd","addEventListener","onFocus","isSelected","parentElement","closest","index"],"sources":["@wordpress/rich-text/src/component/use-input-and-selection.js"],"sourcesContent":["/**\n * WordPress dependencies\n */\nimport { useRef } from '@wordpress/element';\nimport { useRefEffect } from '@wordpress/compose';\n\n/**\n * Internal dependencies\n */\nimport { getActiveFormats } from '../get-active-formats';\nimport { updateFormats } from '../update-formats';\n\n/**\n * All inserting input types that would insert HTML into the DOM.\n *\n * @see https://www.w3.org/TR/input-events-2/#interface-InputEvent-Attributes\n *\n * @type {Set}\n */\nconst INSERTION_INPUT_TYPES_TO_IGNORE = new Set( [\n\t'insertParagraph',\n\t'insertOrderedList',\n\t'insertUnorderedList',\n\t'insertHorizontalRule',\n\t'insertLink',\n] );\n\nconst EMPTY_ACTIVE_FORMATS = [];\n\nconst PLACEHOLDER_ATTR_NAME = 'data-rich-text-placeholder';\n\n/**\n * If the selection is set on the placeholder element, collapse the selection to\n * the start (before the placeholder).\n *\n * @param {Window} defaultView\n */\nfunction fixPlaceholderSelection( defaultView ) {\n\tconst selection = defaultView.getSelection();\n\tconst { anchorNode, anchorOffset } = selection;\n\n\tif ( anchorNode.nodeType !== anchorNode.ELEMENT_NODE ) {\n\t\treturn;\n\t}\n\n\tconst targetNode = anchorNode.childNodes[ anchorOffset ];\n\n\tif (\n\t\t! targetNode ||\n\t\ttargetNode.nodeType !== targetNode.ELEMENT_NODE ||\n\t\t! targetNode.hasAttribute( PLACEHOLDER_ATTR_NAME )\n\t) {\n\t\treturn;\n\t}\n\n\tselection.collapseToStart();\n}\n\nexport function useInputAndSelection( props ) {\n\tconst propsRef = useRef( props );\n\tpropsRef.current = props;\n\treturn useRefEffect( ( element ) => {\n\t\tconst { ownerDocument } = element;\n\t\tconst { defaultView } = ownerDocument;\n\n\t\tlet isComposing = false;\n\n\t\tfunction onInput( event ) {\n\t\t\t// Do not trigger a change if characters are being composed.\n\t\t\t// Browsers  will usually emit a final `input` event when the\n\t\t\t// characters are composed.\n\t\t\t// As of December 2019, Safari doesn't support\n\t\t\t// nativeEvent.isComposing.\n\t\t\tif ( isComposing ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tlet inputType;\n\n\t\t\tif ( event ) {\n\t\t\t\tinputType = event.inputType;\n\t\t\t}\n\n\t\t\tconst { record, applyRecord, createRecord, handleChange } =\n\t\t\t\tpropsRef.current;\n\n\t\t\t// The browser formatted something or tried to insert HTML.\n\t\t\t// Overwrite it. It will be handled later by the format library if\n\t\t\t// needed.\n\t\t\tif (\n\t\t\t\tinputType &&\n\t\t\t\t( inputType.indexOf( 'format' ) === 0 ||\n\t\t\t\t\tINSERTION_INPUT_TYPES_TO_IGNORE.has( inputType ) )\n\t\t\t) {\n\t\t\t\tapplyRecord( record.current );\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst currentValue = createRecord();\n\t\t\tconst { start, activeFormats: oldActiveFormats = [] } =\n\t\t\t\trecord.current;\n\n\t\t\t// Update the formats between the last and new caret position.\n\t\t\tconst change = updateFormats( {\n\t\t\t\tvalue: currentValue,\n\t\t\t\tstart,\n\t\t\t\tend: currentValue.start,\n\t\t\t\tformats: oldActiveFormats,\n\t\t\t} );\n\n\t\t\thandleChange( change );\n\t\t}\n\n\t\t/**\n\t\t * Syncs the selection to local state. A callback for the\n\t\t * `selectionchange` event.\n\t\t */\n\t\tfunction handleSelectionChange() {\n\t\t\tconst { record, applyRecord, createRecord, onSelectionChange } =\n\t\t\t\tpropsRef.current;\n\n\t\t\t// Check if the implementor disabled editing. `contentEditable`\n\t\t\t// does disable input, but not text selection, so we must ignore\n\t\t\t// selection changes.\n\t\t\tif ( element.contentEditable !== 'true' ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// If the selection changes where the active element is a parent of\n\t\t\t// the rich text instance (writing flow), call `onSelectionChange`\n\t\t\t// for the rich text instance that contains the start or end of the\n\t\t\t// selection.\n\t\t\tif ( ownerDocument.activeElement !== element ) {\n\t\t\t\t// Only process if the active elment is contentEditable, either\n\t\t\t\t// this rich text instance or the writing flow parent. Fixes a\n\t\t\t\t// bug in Firefox where it strangely selects the closest\n\t\t\t\t// contentEditable element, even though the click was outside\n\t\t\t\t// any contentEditable element.\n\t\t\t\tif ( ownerDocument.activeElement.contentEditable !== 'true' ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif ( ! ownerDocument.activeElement.contains( element ) ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst selection = defaultView.getSelection();\n\t\t\t\tconst { anchorNode, focusNode } = selection;\n\n\t\t\t\tif (\n\t\t\t\t\telement.contains( anchorNode ) &&\n\t\t\t\t\telement !== anchorNode &&\n\t\t\t\t\telement.contains( focusNode ) &&\n\t\t\t\t\telement !== focusNode\n\t\t\t\t) {\n\t\t\t\t\tconst { start, end } = createRecord();\n\t\t\t\t\trecord.current.activeFormats = EMPTY_ACTIVE_FORMATS;\n\t\t\t\t\tonSelectionChange( start, end );\n\t\t\t\t} else if (\n\t\t\t\t\telement.contains( anchorNode ) &&\n\t\t\t\t\telement !== anchorNode\n\t\t\t\t) {\n\t\t\t\t\tconst { start, end: offset = start } = createRecord();\n\t\t\t\t\trecord.current.activeFormats = EMPTY_ACTIVE_FORMATS;\n\t\t\t\t\tonSelectionChange( offset );\n\t\t\t\t} else if ( element.contains( focusNode ) ) {\n\t\t\t\t\tconst { start, end: offset = start } = createRecord();\n\t\t\t\t\trecord.current.activeFormats = EMPTY_ACTIVE_FORMATS;\n\t\t\t\t\tonSelectionChange( undefined, offset );\n\t\t\t\t}\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// In case of a keyboard event, ignore selection changes during\n\t\t\t// composition.\n\t\t\tif ( isComposing ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst { start, end, text } = createRecord();\n\t\t\tconst oldRecord = record.current;\n\n\t\t\t// Fallback mechanism for IE11, which doesn't support the input event.\n\t\t\t// Any input results in a selection change.\n\t\t\tif ( text !== oldRecord.text ) {\n\t\t\t\tonInput();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif ( start === oldRecord.start && end === oldRecord.end ) {\n\t\t\t\t// Sometimes the browser may set the selection on the placeholder\n\t\t\t\t// element, in which case the caret is not visible. We need to set\n\t\t\t\t// the caret before the placeholder if that's the case.\n\t\t\t\tif ( oldRecord.text.length === 0 && start === 0 ) {\n\t\t\t\t\tfixPlaceholderSelection( defaultView );\n\t\t\t\t}\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst newValue = {\n\t\t\t\t...oldRecord,\n\t\t\t\tstart,\n\t\t\t\tend,\n\t\t\t\t// _newActiveFormats may be set on arrow key navigation to control\n\t\t\t\t// the right boundary position. If undefined, getActiveFormats will\n\t\t\t\t// give the active formats according to the browser.\n\t\t\t\tactiveFormats: oldRecord._newActiveFormats,\n\t\t\t\t_newActiveFormats: undefined,\n\t\t\t};\n\n\t\t\tconst newActiveFormats = getActiveFormats(\n\t\t\t\tnewValue,\n\t\t\t\tEMPTY_ACTIVE_FORMATS\n\t\t\t);\n\n\t\t\t// Update the value with the new active formats.\n\t\t\tnewValue.activeFormats = newActiveFormats;\n\n\t\t\t// It is important that the internal value is updated first,\n\t\t\t// otherwise the value will be wrong on render!\n\t\t\trecord.current = newValue;\n\t\t\tapplyRecord( newValue, { domOnly: true } );\n\t\t\tonSelectionChange( start, end );\n\t\t}\n\n\t\tfunction onCompositionStart() {\n\t\t\tisComposing = true;\n\t\t\t// Do not update the selection when characters are being composed as\n\t\t\t// this rerenders the component and might destroy internal browser\n\t\t\t// editing state.\n\t\t\townerDocument.removeEventListener(\n\t\t\t\t'selectionchange',\n\t\t\t\thandleSelectionChange\n\t\t\t);\n\t\t\t// Remove the placeholder. Since the rich text value doesn't update\n\t\t\t// during composition, the placeholder doesn't get removed. There's\n\t\t\t// no need to re-add it, when the value is updated on compositionend\n\t\t\t// it will be re-added when the value is empty.\n\t\t\telement.querySelector( `[${ PLACEHOLDER_ATTR_NAME }]` )?.remove();\n\t\t}\n\n\t\tfunction onCompositionEnd() {\n\t\t\tisComposing = false;\n\t\t\t// Ensure the value is up-to-date for browsers that don't emit a final\n\t\t\t// input event after composition.\n\t\t\tonInput( { inputType: 'insertText' } );\n\t\t\t// Tracking selection changes can be resumed.\n\t\t\townerDocument.addEventListener(\n\t\t\t\t'selectionchange',\n\t\t\t\thandleSelectionChange\n\t\t\t);\n\t\t}\n\n\t\tfunction onFocus() {\n\t\t\tconst { record, isSelected, onSelectionChange, applyRecord } =\n\t\t\t\tpropsRef.current;\n\n\t\t\t// When the whole editor is editable, let writing flow handle\n\t\t\t// selection.\n\t\t\tif ( element.parentElement.closest( '[contenteditable=\"true\"]' ) ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif ( ! isSelected ) {\n\t\t\t\t// We know for certain that on focus, the old selection is invalid.\n\t\t\t\t// It will be recalculated on the next mouseup, keyup, or touchend\n\t\t\t\t// event.\n\t\t\t\tconst index = undefined;\n\n\t\t\t\trecord.current = {\n\t\t\t\t\t...record.current,\n\t\t\t\t\tstart: index,\n\t\t\t\t\tend: index,\n\t\t\t\t\tactiveFormats: EMPTY_ACTIVE_FORMATS,\n\t\t\t\t};\n\t\t\t} else {\n\t\t\t\tapplyRecord( record.current );\n\t\t\t\tonSelectionChange( record.current.start, record.current.end );\n\t\t\t}\n\t\t}\n\n\t\telement.addEventListener( 'input', onInput );\n\t\telement.addEventListener( 'compositionstart', onCompositionStart );\n\t\telement.addEventListener( 'compositionend', onCompositionEnd );\n\t\telement.addEventListener( 'focus', onFocus );\n\t\townerDocument.addEventListener(\n\t\t\t'selectionchange',\n\t\t\thandleSelectionChange\n\t\t);\n\t\treturn () => {\n\t\t\telement.removeEventListener( 'input', onInput );\n\t\t\telement.removeEventListener(\n\t\t\t\t'compositionstart',\n\t\t\t\tonCompositionStart\n\t\t\t);\n\t\t\telement.removeEventListener( 'compositionend', onCompositionEnd );\n\t\t\telement.removeEventListener( 'focus', onFocus );\n\t\t\townerDocument.removeEventListener(\n\t\t\t\t'selectionchange',\n\t\t\t\thandleSelectionChange\n\t\t\t);\n\t\t};\n\t}, [] );\n}\n"],"mappings":"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"}