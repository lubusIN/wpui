{"version":3,"names":["useIsFocused","useNavigation","useFocusEffect","ScrollView","TouchableHighlight","useWindowDimensions","View","BottomSheetContext","useRef","useCallback","useContext","useMemo","BottomSheetNavigationContext","styles","BottomSheetNavigationScreen","children","fullScreen","isScrollable","isNested","name","navigation","maxHeight","isFocused","onHandleHardwareButtonPress","shouldEnableBottomSheetMaxHeight","setIsFullScreen","listProps","safeAreaBottomInset","height","windowHeight","setHeight","canGoBack","goBack","current","onLayout","nativeEvent","layout","createElement","testID","accessible","style","scrollableContent","paddingBottom"],"sources":["@wordpress/components/src/mobile/bottom-sheet/bottom-sheet-navigation/navigation-screen.native.js"],"sourcesContent":["/**\n * External dependencies\n */\nimport {\n\tuseIsFocused,\n\tuseNavigation,\n\tuseFocusEffect,\n} from '@react-navigation/native';\nimport {\n\tScrollView,\n\tTouchableHighlight,\n\tuseWindowDimensions,\n\tView,\n} from 'react-native';\n\n/**\n * WordPress dependencies\n */\nimport { BottomSheetContext } from '@wordpress/components';\nimport { useRef, useCallback, useContext, useMemo } from '@wordpress/element';\n\n/**\n * Internal dependencies\n */\nimport { BottomSheetNavigationContext } from './bottom-sheet-navigation-context';\nimport styles from './styles.scss';\n\nconst BottomSheetNavigationScreen = ( {\n\tchildren,\n\tfullScreen,\n\tisScrollable,\n\tisNested,\n\tname,\n} ) => {\n\tconst navigation = useNavigation();\n\tconst maxHeight = useRef( 0 );\n\tconst isFocused = useIsFocused();\n\tconst {\n\t\tonHandleHardwareButtonPress,\n\t\tshouldEnableBottomSheetMaxHeight,\n\t\tsetIsFullScreen,\n\t\tlistProps,\n\t\tsafeAreaBottomInset,\n\t} = useContext( BottomSheetContext );\n\tconst { height: windowHeight } = useWindowDimensions();\n\n\tconst { setHeight } = useContext( BottomSheetNavigationContext );\n\n\tuseFocusEffect(\n\t\tuseCallback( () => {\n\t\t\tonHandleHardwareButtonPress( () => {\n\t\t\t\tif ( navigation.canGoBack() ) {\n\t\t\t\t\tshouldEnableBottomSheetMaxHeight( true );\n\t\t\t\t\tnavigation.goBack();\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\tonHandleHardwareButtonPress( null );\n\t\t\t\treturn false;\n\t\t\t} );\n\t\t\t/**\n\t\t\t * TODO: onHandleHardwareButtonPress stores a single value, which means\n\t\t\t * future invocations from sibling screens can replace the callback for\n\t\t\t * the currently active screen. Currently, the empty dependency array\n\t\t\t * passed to useCallback here is what prevents erroneous callback\n\t\t\t * replacements, but leveraging memoization to achieve this is brittle and\n\t\t\t * explicitly discouraged in the React documentation.\n\t\t\t * https://reactjs.org/docs/hooks-reference.html#usememo\n\t\t\t *\n\t\t\t * Ideally, we refactor onHandleHardwareButtonPress to manage multiple\n\t\t\t * callbacks triggered based upon which screen is currently active.\n\t\t\t *\n\t\t\t * Related: https://github.com/WordPress/gutenberg/pull/36328#discussion_r768897546\n\t\t\t */\n\t\t\t// see https://github.com/WordPress/gutenberg/pull/41166\n\t\t\t// eslint-disable-next-line react-hooks/exhaustive-deps\n\t\t}, [] )\n\t);\n\n\tuseFocusEffect(\n\t\tuseCallback( () => {\n\t\t\tif ( fullScreen ) {\n\t\t\t\tsetHeight( windowHeight );\n\t\t\t\tsetIsFullScreen( true );\n\t\t\t} else if ( maxHeight.current !== 0 ) {\n\t\t\t\tsetIsFullScreen( false );\n\t\t\t\tsetHeight( maxHeight.current );\n\t\t\t}\n\t\t\treturn () => {};\n\t\t}, [ fullScreen, setHeight, setIsFullScreen, windowHeight ] )\n\t);\n\n\tconst onLayout = ( { nativeEvent } ) => {\n\t\tif ( fullScreen ) {\n\t\t\treturn;\n\t\t}\n\t\tconst { height } = nativeEvent.layout;\n\t\tif ( maxHeight.current !== height && isFocused ) {\n\t\t\tmaxHeight.current = height;\n\t\t\tsetHeight( height );\n\t\t}\n\t};\n\n\treturn useMemo( () => {\n\t\treturn isScrollable || isNested ? (\n\t\t\t<View\n\t\t\t\tonLayout={ onLayout }\n\t\t\t\ttestID={ `navigation-screen-${ name }` }\n\t\t\t>\n\t\t\t\t{ children }\n\t\t\t</View>\n\t\t) : (\n\t\t\t<ScrollView { ...listProps }>\n\t\t\t\t<TouchableHighlight accessible={ false }>\n\t\t\t\t\t<View\n\t\t\t\t\t\tonLayout={ onLayout }\n\t\t\t\t\t\ttestID={ `navigation-screen-${ name }` }\n\t\t\t\t\t>\n\t\t\t\t\t\t{ children }\n\t\t\t\t\t\t{ ! isNested && (\n\t\t\t\t\t\t\t<View\n\t\t\t\t\t\t\t\tstyle={ {\n\t\t\t\t\t\t\t\t\theight:\n\t\t\t\t\t\t\t\t\t\tsafeAreaBottomInset ||\n\t\t\t\t\t\t\t\t\t\tstyles.scrollableContent.paddingBottom,\n\t\t\t\t\t\t\t\t} }\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t) }\n\t\t\t\t\t</View>\n\t\t\t\t</TouchableHighlight>\n\t\t\t</ScrollView>\n\t\t);\n\t\t// Disable reason: deferring this refactor to the native team.\n\t\t// see https://github.com/WordPress/gutenberg/pull/41166\n\t\t// eslint-disable-next-line react-hooks/exhaustive-deps\n\t}, [\n\t\tchildren,\n\t\tisFocused,\n\t\tsafeAreaBottomInset,\n\t\tlistProps,\n\t\tname,\n\t\tisScrollable,\n\t\tisNested,\n\t\tonLayout,\n\t] );\n};\n\nexport default BottomSheetNavigationScreen;\n"],"mappings":"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"}