{"version":3,"names":["useCallback","useMemo","useState","styles","parseQuantityAndUnitFromRawValue","useContextSystem","useCx","sanitizeBorder","border","hasNoWidth","width","undefined","hasNoColor","color","useBorderControl","props","className","colors","isCompact","onChange","enableAlpha","enableStyle","shouldSanitizeBorder","size","value","__experimentalIsRenderedInSidebar","otherProps","widthValue","originalWidthUnit","widthUnit","hadPreviousZeroWidth","colorSelection","setColorSelection","styleSelection","setStyleSelection","onBorderChange","newBorder","onWidthChange","newWidth","newWidthValue","parsedValue","hasZeroWidth","updatedBorder","style","onSliderChange","cx","classes","borderControl","wrapperWidth","innerWrapperClassName","widthStyle","heightStyle","wrapperHeight","innerWrapper","sliderClassName","borderSlider","inputWidth","previousStyleSelection"],"sources":["@wordpress/components/src/border-control/border-control/hook.ts"],"sourcesContent":["/**\n * WordPress dependencies\n */\nimport { useCallback, useMemo, useState } from '@wordpress/element';\n\n/**\n * Internal dependencies\n */\nimport * as styles from '../styles';\nimport { parseQuantityAndUnitFromRawValue } from '../../unit-control/utils';\nimport type { WordPressComponentProps } from '../../ui/context';\nimport { useContextSystem } from '../../ui/context';\nimport { useCx } from '../../utils/hooks/use-cx';\n\nimport type { Border, BorderControlProps } from '../types';\n\nconst sanitizeBorder = ( border?: Border ) => {\n\tconst hasNoWidth = border?.width === undefined || border.width === '';\n\tconst hasNoColor = border?.color === undefined;\n\n\t// If width and color are undefined, unset any style selection as well.\n\tif ( hasNoWidth && hasNoColor ) {\n\t\treturn undefined;\n\t}\n\n\treturn border;\n};\n\nexport function useBorderControl(\n\tprops: WordPressComponentProps< BorderControlProps, 'div' >\n) {\n\tconst {\n\t\tclassName,\n\t\tcolors = [],\n\t\tisCompact,\n\t\tonChange,\n\t\tenableAlpha = true,\n\t\tenableStyle = true,\n\t\tshouldSanitizeBorder = true,\n\t\tsize = 'default',\n\t\tvalue: border,\n\t\twidth,\n\t\t__experimentalIsRenderedInSidebar = false,\n\t\t...otherProps\n\t} = useContextSystem( props, 'BorderControl' );\n\n\tconst [ widthValue, originalWidthUnit ] = parseQuantityAndUnitFromRawValue(\n\t\tborder?.width\n\t);\n\tconst widthUnit = originalWidthUnit || 'px';\n\tconst hadPreviousZeroWidth = widthValue === 0;\n\n\tconst [ colorSelection, setColorSelection ] = useState< string >();\n\tconst [ styleSelection, setStyleSelection ] = useState< string >();\n\n\tconst onBorderChange = useCallback(\n\t\t( newBorder?: Border ) => {\n\t\t\tif ( shouldSanitizeBorder ) {\n\t\t\t\treturn onChange( sanitizeBorder( newBorder ) );\n\t\t\t}\n\n\t\t\tonChange( newBorder );\n\t\t},\n\t\t[ onChange, shouldSanitizeBorder ]\n\t);\n\n\tconst onWidthChange = useCallback(\n\t\t( newWidth?: string ) => {\n\t\t\tconst newWidthValue = newWidth === '' ? undefined : newWidth;\n\t\t\tconst [ parsedValue ] =\n\t\t\t\tparseQuantityAndUnitFromRawValue( newWidth );\n\t\t\tconst hasZeroWidth = parsedValue === 0;\n\t\t\tconst updatedBorder = { ...border, width: newWidthValue };\n\n\t\t\t// Setting the border width explicitly to zero will also set the\n\t\t\t// border style to `none` and clear the border color.\n\t\t\tif ( hasZeroWidth && ! hadPreviousZeroWidth ) {\n\t\t\t\t// Before clearing the color and style selections, keep track of\n\t\t\t\t// the current selections so they can be restored when the width\n\t\t\t\t// changes to a non-zero value.\n\t\t\t\tsetColorSelection( border?.color );\n\t\t\t\tsetStyleSelection( border?.style );\n\n\t\t\t\t// Clear the color and style border properties.\n\t\t\t\tupdatedBorder.color = undefined;\n\t\t\t\tupdatedBorder.style = 'none';\n\t\t\t}\n\n\t\t\t// Selection has changed from zero border width to non-zero width.\n\t\t\tif ( ! hasZeroWidth && hadPreviousZeroWidth ) {\n\t\t\t\t// Restore previous border color and style selections if width\n\t\t\t\t// is now not zero.\n\t\t\t\tif ( updatedBorder.color === undefined ) {\n\t\t\t\t\tupdatedBorder.color = colorSelection;\n\t\t\t\t}\n\t\t\t\tif ( updatedBorder.style === 'none' ) {\n\t\t\t\t\tupdatedBorder.style = styleSelection;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tonBorderChange( updatedBorder );\n\t\t},\n\t\t[\n\t\t\tborder,\n\t\t\thadPreviousZeroWidth,\n\t\t\tcolorSelection,\n\t\t\tstyleSelection,\n\t\t\tonBorderChange,\n\t\t]\n\t);\n\n\tconst onSliderChange = useCallback(\n\t\t( value?: number ) => {\n\t\t\tonWidthChange( `${ value }${ widthUnit }` );\n\t\t},\n\t\t[ onWidthChange, widthUnit ]\n\t);\n\n\t// Generate class names.\n\tconst cx = useCx();\n\tconst classes = useMemo( () => {\n\t\treturn cx( styles.borderControl, className );\n\t}, [ className, cx ] );\n\n\tlet wrapperWidth = width;\n\tif ( isCompact ) {\n\t\t// Widths below represent the minimum usable width for compact controls.\n\t\t// Taller controls contain greater internal padding, thus greater width.\n\t\twrapperWidth = size === '__unstable-large' ? '116px' : '90px';\n\t}\n\tconst innerWrapperClassName = useMemo( () => {\n\t\tconst widthStyle = !! wrapperWidth && styles.wrapperWidth;\n\t\tconst heightStyle = styles.wrapperHeight( size );\n\n\t\treturn cx( styles.innerWrapper(), widthStyle, heightStyle );\n\t}, [ wrapperWidth, cx, size ] );\n\n\tconst sliderClassName = useMemo( () => {\n\t\treturn cx( styles.borderSlider() );\n\t}, [ cx ] );\n\n\treturn {\n\t\t...otherProps,\n\t\tclassName: classes,\n\t\tcolors,\n\t\tenableAlpha,\n\t\tenableStyle,\n\t\tinnerWrapperClassName,\n\t\tinputWidth: wrapperWidth,\n\t\tonBorderChange,\n\t\tonSliderChange,\n\t\tonWidthChange,\n\t\tpreviousStyleSelection: styleSelection,\n\t\tsliderClassName,\n\t\tvalue: border,\n\t\twidthUnit,\n\t\twidthValue,\n\t\tsize,\n\t\t__experimentalIsRenderedInSidebar,\n\t};\n}\n"],"mappings":"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"}