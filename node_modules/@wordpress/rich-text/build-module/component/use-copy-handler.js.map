{"version":3,"names":["useRef","useRefEffect","toHTMLString","isCollapsed","slice","getTextContent","useCopyHandler","props","propsRef","current","element","onCopy","event","record","preserveWhiteSpace","ownerDocument","contains","activeElement","selectedRecord","plainText","html","value","clipboardData","setData","preventDefault","type","execCommand","addEventListener","removeEventListener"],"sources":["@wordpress/rich-text/src/component/use-copy-handler.js"],"sourcesContent":["/**\n * WordPress dependencies\n */\nimport { useRef } from '@wordpress/element';\nimport { useRefEffect } from '@wordpress/compose';\n\n/**\n * Internal dependencies\n */\nimport { toHTMLString } from '../to-html-string';\nimport { isCollapsed } from '../is-collapsed';\nimport { slice } from '../slice';\nimport { getTextContent } from '../get-text-content';\n\nexport function useCopyHandler( props ) {\n\tconst propsRef = useRef( props );\n\tpropsRef.current = props;\n\treturn useRefEffect( ( element ) => {\n\t\tfunction onCopy( event ) {\n\t\t\tconst { record, preserveWhiteSpace } = propsRef.current;\n\t\t\tconst { ownerDocument } = element;\n\t\t\tif (\n\t\t\t\tisCollapsed( record.current ) ||\n\t\t\t\t! element.contains( ownerDocument.activeElement )\n\t\t\t) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst selectedRecord = slice( record.current );\n\t\t\tconst plainText = getTextContent( selectedRecord );\n\t\t\tconst html = toHTMLString( {\n\t\t\t\tvalue: selectedRecord,\n\t\t\t\tpreserveWhiteSpace,\n\t\t\t} );\n\t\t\tevent.clipboardData.setData( 'text/plain', plainText );\n\t\t\tevent.clipboardData.setData( 'text/html', html );\n\t\t\tevent.clipboardData.setData( 'rich-text', 'true' );\n\t\t\tevent.preventDefault();\n\n\t\t\tif ( event.type === 'cut' ) {\n\t\t\t\townerDocument.execCommand( 'delete' );\n\t\t\t}\n\t\t}\n\n\t\telement.addEventListener( 'copy', onCopy );\n\t\telement.addEventListener( 'cut', onCopy );\n\t\treturn () => {\n\t\t\telement.removeEventListener( 'copy', onCopy );\n\t\t\telement.removeEventListener( 'cut', onCopy );\n\t\t};\n\t}, [] );\n}\n"],"mappings":"AAAA;AACA;AACA;AACA,SAASA,MAAM,QAAQ,oBAAoB;AAC3C,SAASC,YAAY,QAAQ,oBAAoB;;AAEjD;AACA;AACA;AACA,SAASC,YAAY,QAAQ,mBAAmB;AAChD,SAASC,WAAW,QAAQ,iBAAiB;AAC7C,SAASC,KAAK,QAAQ,UAAU;AAChC,SAASC,cAAc,QAAQ,qBAAqB;AAEpD,OAAO,SAASC,cAAcA,CAAEC,KAAK,EAAG;EACvC,MAAMC,QAAQ,GAAGR,MAAM,CAAEO,KAAM,CAAC;EAChCC,QAAQ,CAACC,OAAO,GAAGF,KAAK;EACxB,OAAON,YAAY,CAAIS,OAAO,IAAM;IACnC,SAASC,MAAMA,CAAEC,KAAK,EAAG;MACxB,MAAM;QAAEC,MAAM;QAAEC;MAAmB,CAAC,GAAGN,QAAQ,CAACC,OAAO;MACvD,MAAM;QAAEM;MAAc,CAAC,GAAGL,OAAO;MACjC,IACCP,WAAW,CAAEU,MAAM,CAACJ,OAAQ,CAAC,IAC7B,CAAEC,OAAO,CAACM,QAAQ,CAAED,aAAa,CAACE,aAAc,CAAC,EAChD;QACD;MACD;MAEA,MAAMC,cAAc,GAAGd,KAAK,CAAES,MAAM,CAACJ,OAAQ,CAAC;MAC9C,MAAMU,SAAS,GAAGd,cAAc,CAAEa,cAAe,CAAC;MAClD,MAAME,IAAI,GAAGlB,YAAY,CAAE;QAC1BmB,KAAK,EAAEH,cAAc;QACrBJ;MACD,CAAE,CAAC;MACHF,KAAK,CAACU,aAAa,CAACC,OAAO,CAAE,YAAY,EAAEJ,SAAU,CAAC;MACtDP,KAAK,CAACU,aAAa,CAACC,OAAO,CAAE,WAAW,EAAEH,IAAK,CAAC;MAChDR,KAAK,CAACU,aAAa,CAACC,OAAO,CAAE,WAAW,EAAE,MAAO,CAAC;MAClDX,KAAK,CAACY,cAAc,CAAC,CAAC;MAEtB,IAAKZ,KAAK,CAACa,IAAI,KAAK,KAAK,EAAG;QAC3BV,aAAa,CAACW,WAAW,CAAE,QAAS,CAAC;MACtC;IACD;IAEAhB,OAAO,CAACiB,gBAAgB,CAAE,MAAM,EAAEhB,MAAO,CAAC;IAC1CD,OAAO,CAACiB,gBAAgB,CAAE,KAAK,EAAEhB,MAAO,CAAC;IACzC,OAAO,MAAM;MACZD,OAAO,CAACkB,mBAAmB,CAAE,MAAM,EAAEjB,MAAO,CAAC;MAC7CD,OAAO,CAACkB,mBAAmB,CAAE,KAAK,EAAEjB,MAAO,CAAC;IAC7C,CAAC;EACF,CAAC,EAAE,EAAG,CAAC;AACR"}