{"version":3,"names":["_element","require","styles","_interopRequireWildcard","_context","_useCx","_getRequireWildcardCache","nodeInterop","WeakMap","cacheBabelInterop","cacheNodeInterop","obj","__esModule","default","cache","has","get","newObj","hasPropertyDescriptor","Object","defineProperty","getOwnPropertyDescriptor","key","prototype","hasOwnProperty","call","desc","set","DEFAULT_COLUMNS","generateMenuItems","panelItems","shouldReset","currentMenuItems","menuItemOrder","newMenuItems","optional","menuItems","forEach","hasValue","isShownByDefault","label","group","existingItemValue","value","keys","isMenuItemTypeEmpty","length","useToolsPanel","props","className","headingLevel","resetAll","panelId","hasInnerWrapper","shouldRenderPlaceholderItems","__experimentalFirstVisibleItemClass","__experimentalLastVisibleItemClass","otherProps","useContextSystem","isResetting","useRef","wasResetting","current","useEffect","setPanelItems","useState","setMenuItemOrder","resetAllFilters","setResetAllFilters","registerPanelItem","useCallback","item","items","newItems","existingIndex","findIndex","oldItem","splice","includes","deregisterPanelItem","index","registerResetAllFilter","newFilter","filters","deregisterResetAllFilter","filterToRemove","filter","setMenuItems","prevState","flagItemCustomization","newState","areAllOptionalControlsHidden","setAreAllOptionalControlsHidden","allControlsHidden","entries","some","isSelected","cx","useCx","classes","useMemo","wrapperStyle","ToolsPanelWithInnerWrapper","emptyStyle","ToolsPanelHiddenInnerWrapper","ToolsPanel","toggleItem","currentItem","find","menuGroup","resetAllItems","resetMenuItems","getFirstVisibleItemLabel","optionalItems","firstItem","firstDisplayedItem","lastDisplayedItem","reverse","panelContext","hasMenuItems"],"sources":["@wordpress/components/src/tools-panel/tools-panel/hook.ts"],"sourcesContent":["/**\n * WordPress dependencies\n */\nimport {\n\tuseCallback,\n\tuseEffect,\n\tuseMemo,\n\tuseRef,\n\tuseState,\n} from '@wordpress/element';\n\n/**\n * Internal dependencies\n */\nimport * as styles from '../styles';\nimport type { WordPressComponentProps } from '../../ui/context';\nimport { useContextSystem } from '../../ui/context';\nimport { useCx } from '../../utils/hooks/use-cx';\nimport type {\n\tToolsPanelItem,\n\tToolsPanelMenuItemKey,\n\tToolsPanelMenuItems,\n\tToolsPanelMenuItemsConfig,\n\tToolsPanelProps,\n\tResetAllFilter,\n} from '../types';\n\nconst DEFAULT_COLUMNS = 2;\n\nconst generateMenuItems = ( {\n\tpanelItems,\n\tshouldReset,\n\tcurrentMenuItems,\n\tmenuItemOrder,\n}: ToolsPanelMenuItemsConfig ) => {\n\tconst newMenuItems: ToolsPanelMenuItems = { default: {}, optional: {} };\n\tconst menuItems: ToolsPanelMenuItems = { default: {}, optional: {} };\n\n\tpanelItems.forEach( ( { hasValue, isShownByDefault, label } ) => {\n\t\tconst group = isShownByDefault ? 'default' : 'optional';\n\n\t\t// If a menu item for this label has already been flagged as customized\n\t\t// (for default controls), or toggled on (for optional controls), do not\n\t\t// overwrite its value as those controls would lose that state.\n\t\tconst existingItemValue = currentMenuItems?.[ group ]?.[ label ];\n\t\tconst value = existingItemValue ? existingItemValue : hasValue();\n\n\t\tnewMenuItems[ group ][ label ] = shouldReset ? false : value;\n\t} );\n\n\t// Loop the known, previously registered items first to maintain menu order.\n\tmenuItemOrder.forEach( ( key ) => {\n\t\tif ( newMenuItems.default.hasOwnProperty( key ) ) {\n\t\t\tmenuItems.default[ key ] = newMenuItems.default[ key ];\n\t\t}\n\n\t\tif ( newMenuItems.optional.hasOwnProperty( key ) ) {\n\t\t\tmenuItems.optional[ key ] = newMenuItems.optional[ key ];\n\t\t}\n\t} );\n\n\t// Loop newMenuItems object adding any that aren't in the known items order.\n\tObject.keys( newMenuItems.default ).forEach( ( key ) => {\n\t\tif ( ! menuItems.default.hasOwnProperty( key ) ) {\n\t\t\tmenuItems.default[ key ] = newMenuItems.default[ key ];\n\t\t}\n\t} );\n\n\tObject.keys( newMenuItems.optional ).forEach( ( key ) => {\n\t\tif ( ! menuItems.optional.hasOwnProperty( key ) ) {\n\t\t\tmenuItems.optional[ key ] = newMenuItems.optional[ key ];\n\t\t}\n\t} );\n\n\treturn menuItems;\n};\n\nconst isMenuItemTypeEmpty = (\n\tobj?: ToolsPanelMenuItems[ ToolsPanelMenuItemKey ]\n) => obj && Object.keys( obj ).length === 0;\n\nexport function useToolsPanel(\n\tprops: WordPressComponentProps< ToolsPanelProps, 'div' >\n) {\n\tconst {\n\t\tclassName,\n\t\theadingLevel = 2,\n\t\tresetAll,\n\t\tpanelId,\n\t\thasInnerWrapper = false,\n\t\tshouldRenderPlaceholderItems = false,\n\t\t__experimentalFirstVisibleItemClass,\n\t\t__experimentalLastVisibleItemClass,\n\t\t...otherProps\n\t} = useContextSystem( props, 'ToolsPanel' );\n\n\tconst isResetting = useRef( false );\n\tconst wasResetting = isResetting.current;\n\n\t// `isResetting` is cleared via this hook to effectively batch together\n\t// the resetAll task. Without this, the flag is cleared after the first\n\t// control updates and forces a rerender with subsequent controls then\n\t// believing they need to reset, unfortunately using stale data.\n\tuseEffect( () => {\n\t\tif ( wasResetting ) {\n\t\t\tisResetting.current = false;\n\t\t}\n\t}, [ wasResetting ] );\n\n\t// Allow panel items to register themselves.\n\tconst [ panelItems, setPanelItems ] = useState< ToolsPanelItem[] >( [] );\n\tconst [ menuItemOrder, setMenuItemOrder ] = useState< string[] >( [] );\n\tconst [ resetAllFilters, setResetAllFilters ] = useState<\n\t\tResetAllFilter[]\n\t>( [] );\n\n\tconst registerPanelItem = useCallback(\n\t\t( item: ToolsPanelItem ) => {\n\t\t\t// Add item to panel items.\n\t\t\tsetPanelItems( ( items ) => {\n\t\t\t\tconst newItems = [ ...items ];\n\t\t\t\t// If an item with this label has already been registered, remove it\n\t\t\t\t// first. This can happen when an item is moved between the default\n\t\t\t\t// and optional groups.\n\t\t\t\tconst existingIndex = newItems.findIndex(\n\t\t\t\t\t( oldItem ) => oldItem.label === item.label\n\t\t\t\t);\n\t\t\t\tif ( existingIndex !== -1 ) {\n\t\t\t\t\tnewItems.splice( existingIndex, 1 );\n\t\t\t\t}\n\t\t\t\treturn [ ...newItems, item ];\n\t\t\t} );\n\n\t\t\t// Track the initial order of item registration. This is used for\n\t\t\t// maintaining menu item order later.\n\t\t\tsetMenuItemOrder( ( items ) => {\n\t\t\t\tif ( items.includes( item.label ) ) {\n\t\t\t\t\treturn items;\n\t\t\t\t}\n\n\t\t\t\treturn [ ...items, item.label ];\n\t\t\t} );\n\t\t},\n\t\t[ setPanelItems, setMenuItemOrder ]\n\t);\n\n\t// Panels need to deregister on unmount to avoid orphans in menu state.\n\t// This is an issue when panel items are being injected via SlotFills.\n\tconst deregisterPanelItem = useCallback(\n\t\t( label: string ) => {\n\t\t\t// When switching selections between components injecting matching\n\t\t\t// controls, e.g. both panels have a \"padding\" control, the\n\t\t\t// deregistration of the first panel doesn't occur until after the\n\t\t\t// registration of the next.\n\t\t\tsetPanelItems( ( items ) => {\n\t\t\t\tconst newItems = [ ...items ];\n\t\t\t\tconst index = newItems.findIndex(\n\t\t\t\t\t( item ) => item.label === label\n\t\t\t\t);\n\t\t\t\tif ( index !== -1 ) {\n\t\t\t\t\tnewItems.splice( index, 1 );\n\t\t\t\t}\n\t\t\t\treturn newItems;\n\t\t\t} );\n\t\t},\n\t\t[ setPanelItems ]\n\t);\n\n\tconst registerResetAllFilter = useCallback(\n\t\t( newFilter: ResetAllFilter ) => {\n\t\t\tsetResetAllFilters( ( filters ) => {\n\t\t\t\treturn [ ...filters, newFilter ];\n\t\t\t} );\n\t\t},\n\t\t[ setResetAllFilters ]\n\t);\n\n\tconst deregisterResetAllFilter = useCallback(\n\t\t( filterToRemove: ResetAllFilter ) => {\n\t\t\tsetResetAllFilters( ( filters ) => {\n\t\t\t\treturn filters.filter(\n\t\t\t\t\t( filter ) => filter !== filterToRemove\n\t\t\t\t);\n\t\t\t} );\n\t\t},\n\t\t[ setResetAllFilters ]\n\t);\n\n\t// Manage and share display state of menu items representing child controls.\n\tconst [ menuItems, setMenuItems ] = useState< ToolsPanelMenuItems >( {\n\t\tdefault: {},\n\t\toptional: {},\n\t} );\n\n\t// Setup menuItems state as panel items register themselves.\n\tuseEffect( () => {\n\t\tsetMenuItems( ( prevState ) => {\n\t\t\tconst items = generateMenuItems( {\n\t\t\t\tpanelItems,\n\t\t\t\tshouldReset: false,\n\t\t\t\tcurrentMenuItems: prevState,\n\t\t\t\tmenuItemOrder,\n\t\t\t} );\n\t\t\treturn items;\n\t\t} );\n\t}, [ panelItems, setMenuItems, menuItemOrder ] );\n\n\t// Force a menu item to be checked.\n\t// This is intended for use with default panel items. They are displayed\n\t// separately to optional items and have different display states,\n\t// we need to update that when their value is customized.\n\tconst flagItemCustomization = useCallback(\n\t\t( label: string, group: ToolsPanelMenuItemKey = 'default' ) => {\n\t\t\tsetMenuItems( ( items ) => {\n\t\t\t\tconst newState = {\n\t\t\t\t\t...items,\n\t\t\t\t\t[ group ]: {\n\t\t\t\t\t\t...items[ group ],\n\t\t\t\t\t\t[ label ]: true,\n\t\t\t\t\t},\n\t\t\t\t};\n\t\t\t\treturn newState;\n\t\t\t} );\n\t\t},\n\t\t[ setMenuItems ]\n\t);\n\n\t// Whether all optional menu items are hidden or not must be tracked\n\t// in order to later determine if the panel display is empty and handle\n\t// conditional display of a plus icon to indicate the presence of further\n\t// menu items.\n\tconst [ areAllOptionalControlsHidden, setAreAllOptionalControlsHidden ] =\n\t\tuseState( false );\n\n\tuseEffect( () => {\n\t\tif (\n\t\t\tisMenuItemTypeEmpty( menuItems?.default ) &&\n\t\t\t! isMenuItemTypeEmpty( menuItems?.optional )\n\t\t) {\n\t\t\tconst allControlsHidden = ! Object.entries(\n\t\t\t\tmenuItems.optional\n\t\t\t).some( ( [ , isSelected ] ) => isSelected );\n\t\t\tsetAreAllOptionalControlsHidden( allControlsHidden );\n\t\t}\n\t}, [ menuItems, setAreAllOptionalControlsHidden ] );\n\n\tconst cx = useCx();\n\tconst classes = useMemo( () => {\n\t\tconst wrapperStyle =\n\t\t\thasInnerWrapper &&\n\t\t\tstyles.ToolsPanelWithInnerWrapper( DEFAULT_COLUMNS );\n\t\tconst emptyStyle =\n\t\t\tisMenuItemTypeEmpty( menuItems?.default ) &&\n\t\t\tareAllOptionalControlsHidden &&\n\t\t\tstyles.ToolsPanelHiddenInnerWrapper;\n\n\t\treturn cx(\n\t\t\tstyles.ToolsPanel( DEFAULT_COLUMNS ),\n\t\t\twrapperStyle,\n\t\t\temptyStyle,\n\t\t\tclassName\n\t\t);\n\t}, [\n\t\tareAllOptionalControlsHidden,\n\t\tclassName,\n\t\tcx,\n\t\thasInnerWrapper,\n\t\tmenuItems,\n\t] );\n\n\t// Toggle the checked state of a menu item which is then used to determine\n\t// display of the item within the panel.\n\tconst toggleItem = useCallback(\n\t\t( label: string ) => {\n\t\t\tconst currentItem = panelItems.find(\n\t\t\t\t( item ) => item.label === label\n\t\t\t);\n\n\t\t\tif ( ! currentItem ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst menuGroup = currentItem.isShownByDefault\n\t\t\t\t? 'default'\n\t\t\t\t: 'optional';\n\n\t\t\tconst newMenuItems = {\n\t\t\t\t...menuItems,\n\t\t\t\t[ menuGroup ]: {\n\t\t\t\t\t...menuItems[ menuGroup ],\n\t\t\t\t\t[ label ]: ! menuItems[ menuGroup ][ label ],\n\t\t\t\t},\n\t\t\t};\n\n\t\t\tsetMenuItems( newMenuItems );\n\t\t},\n\t\t[ menuItems, panelItems, setMenuItems ]\n\t);\n\n\t// Resets display of children and executes resetAll callback if available.\n\tconst resetAllItems = useCallback( () => {\n\t\tif ( typeof resetAll === 'function' ) {\n\t\t\tisResetting.current = true;\n\t\t\tresetAll( resetAllFilters );\n\t\t}\n\n\t\t// Turn off display of all non-default items.\n\t\tconst resetMenuItems = generateMenuItems( {\n\t\t\tpanelItems,\n\t\t\tmenuItemOrder,\n\t\t\tshouldReset: true,\n\t\t} );\n\t\tsetMenuItems( resetMenuItems );\n\t}, [ panelItems, resetAllFilters, resetAll, setMenuItems, menuItemOrder ] );\n\n\t// Assist ItemGroup styling when there are potentially hidden placeholder\n\t// items by identifying first & last items that are toggled on for display.\n\tconst getFirstVisibleItemLabel = ( items: ToolsPanelItem[] ) => {\n\t\tconst optionalItems = menuItems.optional || {};\n\t\tconst firstItem = items.find(\n\t\t\t( item ) => item.isShownByDefault || !! optionalItems[ item.label ]\n\t\t);\n\n\t\treturn firstItem?.label;\n\t};\n\n\tconst firstDisplayedItem = getFirstVisibleItemLabel( panelItems );\n\tconst lastDisplayedItem = getFirstVisibleItemLabel(\n\t\t[ ...panelItems ].reverse()\n\t);\n\n\tconst panelContext = useMemo(\n\t\t() => ( {\n\t\t\tareAllOptionalControlsHidden,\n\t\t\tderegisterPanelItem,\n\t\t\tderegisterResetAllFilter,\n\t\t\tfirstDisplayedItem,\n\t\t\tflagItemCustomization,\n\t\t\thasMenuItems: !! panelItems.length,\n\t\t\tisResetting: isResetting.current,\n\t\t\tlastDisplayedItem,\n\t\t\tmenuItems,\n\t\t\tpanelId,\n\t\t\tregisterPanelItem,\n\t\t\tregisterResetAllFilter,\n\t\t\tshouldRenderPlaceholderItems,\n\t\t\t__experimentalFirstVisibleItemClass,\n\t\t\t__experimentalLastVisibleItemClass,\n\t\t} ),\n\t\t[\n\t\t\tareAllOptionalControlsHidden,\n\t\t\tderegisterPanelItem,\n\t\t\tderegisterResetAllFilter,\n\t\t\tfirstDisplayedItem,\n\t\t\tflagItemCustomization,\n\t\t\tlastDisplayedItem,\n\t\t\tmenuItems,\n\t\t\tpanelId,\n\t\t\tpanelItems,\n\t\t\tregisterResetAllFilter,\n\t\t\tregisterPanelItem,\n\t\t\tshouldRenderPlaceholderItems,\n\t\t\t__experimentalFirstVisibleItemClass,\n\t\t\t__experimentalLastVisibleItemClass,\n\t\t]\n\t);\n\n\treturn {\n\t\t...otherProps,\n\t\theadingLevel,\n\t\tpanelContext,\n\t\tresetAllItems,\n\t\ttoggleItem,\n\t\tclassName: classes,\n\t};\n}\n"],"mappings":"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"}