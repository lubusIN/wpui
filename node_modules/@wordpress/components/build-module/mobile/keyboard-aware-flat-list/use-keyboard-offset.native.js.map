{"version":3,"names":["Keyboard","useEffect","useCallback","useState","useRef","useKeyboardOffset","scrollEnabled","shouldPreventAutomaticScroll","keyboardOffset","setKeyboardOffset","timeoutRef","onKeyboardDidHide","clearTimeout","current","setTimeout","onKeyboardDidShow","endCoordinates","height","onKeyboardWillShow","willShowSubscription","showSubscription","hideSubscription","addListener","remove"],"sources":["@wordpress/components/src/mobile/keyboard-aware-flat-list/use-keyboard-offset.native.js"],"sourcesContent":["/**\n * External dependencies\n */\n\nimport { Keyboard } from 'react-native';\n\n/**\n * WordPress dependencies\n */\nimport { useEffect, useCallback, useState, useRef } from '@wordpress/element';\n\n/**\n * Hook that adds Keyboard listeners to get the offset space\n * when the keyboard is opened, taking into account focused AztecViews.\n *\n * @param {boolean}  scrollEnabled                Whether the scroll is enabled or not.\n * @param {Function} shouldPreventAutomaticScroll Whether to prevent scrolling when there's a Keyboard offset set.\n * @return {[number]} Keyboard offset.\n */\nexport default function useKeyboardOffset(\n\tscrollEnabled,\n\tshouldPreventAutomaticScroll\n) {\n\tconst [ keyboardOffset, setKeyboardOffset ] = useState( 0 );\n\tconst timeoutRef = useRef();\n\n\tconst onKeyboardDidHide = useCallback( () => {\n\t\tif ( shouldPreventAutomaticScroll() ) {\n\t\t\tclearTimeout( timeoutRef.current );\n\t\t\treturn;\n\t\t}\n\n\t\t// A timeout is being used to delay resetting the offset in cases\n\t\t// where the focus is changed to a different TextInput.\n\t\tclearTimeout( timeoutRef.current );\n\t\ttimeoutRef.current = setTimeout( () => {\n\t\t\tsetKeyboardOffset( 0 );\n\t\t}, 200 );\n\t}, [ shouldPreventAutomaticScroll ] );\n\n\tconst onKeyboardDidShow = useCallback( ( { endCoordinates } ) => {\n\t\tclearTimeout( timeoutRef.current );\n\t\tsetKeyboardOffset( endCoordinates.height );\n\t}, [] );\n\n\tconst onKeyboardWillShow = useCallback( () => {\n\t\tclearTimeout( timeoutRef.current );\n\t}, [] );\n\n\tuseEffect( () => {\n\t\tlet willShowSubscription;\n\t\tlet showSubscription;\n\t\tlet hideSubscription;\n\n\t\tif ( scrollEnabled ) {\n\t\t\twillShowSubscription = Keyboard.addListener(\n\t\t\t\t'keyboardWillShow',\n\t\t\t\tonKeyboardWillShow\n\t\t\t);\n\t\t\tshowSubscription = Keyboard.addListener(\n\t\t\t\t'keyboardDidShow',\n\t\t\t\tonKeyboardDidShow\n\t\t\t);\n\t\t\thideSubscription = Keyboard.addListener(\n\t\t\t\t'keyboardDidHide',\n\t\t\t\tonKeyboardDidHide\n\t\t\t);\n\t\t} else {\n\t\t\twillShowSubscription?.remove();\n\t\t\tshowSubscription?.remove();\n\t\t\thideSubscription?.remove();\n\t\t}\n\n\t\treturn () => {\n\t\t\tclearTimeout( timeoutRef.current );\n\t\t\twillShowSubscription?.remove();\n\t\t\tshowSubscription?.remove();\n\t\t\thideSubscription?.remove();\n\t\t};\n\t}, [\n\t\tonKeyboardDidHide,\n\t\tonKeyboardDidShow,\n\t\tonKeyboardWillShow,\n\t\tscrollEnabled,\n\t] );\n\treturn [ keyboardOffset ];\n}\n"],"mappings":"AAAA;AACA;AACA;;AAEA,SAASA,QAAQ,QAAQ,cAAc;;AAEvC;AACA;AACA;AACA,SAASC,SAAS,EAAEC,WAAW,EAAEC,QAAQ,EAAEC,MAAM,QAAQ,oBAAoB;;AAE7E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,SAASC,iBAAiBA,CACxCC,aAAa,EACbC,4BAA4B,EAC3B;EACD,MAAM,CAAEC,cAAc,EAAEC,iBAAiB,CAAE,GAAGN,QAAQ,CAAE,CAAE,CAAC;EAC3D,MAAMO,UAAU,GAAGN,MAAM,CAAC,CAAC;EAE3B,MAAMO,iBAAiB,GAAGT,WAAW,CAAE,MAAM;IAC5C,IAAKK,4BAA4B,CAAC,CAAC,EAAG;MACrCK,YAAY,CAAEF,UAAU,CAACG,OAAQ,CAAC;MAClC;IACD;;IAEA;IACA;IACAD,YAAY,CAAEF,UAAU,CAACG,OAAQ,CAAC;IAClCH,UAAU,CAACG,OAAO,GAAGC,UAAU,CAAE,MAAM;MACtCL,iBAAiB,CAAE,CAAE,CAAC;IACvB,CAAC,EAAE,GAAI,CAAC;EACT,CAAC,EAAE,CAAEF,4BAA4B,CAAG,CAAC;EAErC,MAAMQ,iBAAiB,GAAGb,WAAW,CAAE,CAAE;IAAEc;EAAe,CAAC,KAAM;IAChEJ,YAAY,CAAEF,UAAU,CAACG,OAAQ,CAAC;IAClCJ,iBAAiB,CAAEO,cAAc,CAACC,MAAO,CAAC;EAC3C,CAAC,EAAE,EAAG,CAAC;EAEP,MAAMC,kBAAkB,GAAGhB,WAAW,CAAE,MAAM;IAC7CU,YAAY,CAAEF,UAAU,CAACG,OAAQ,CAAC;EACnC,CAAC,EAAE,EAAG,CAAC;EAEPZ,SAAS,CAAE,MAAM;IAChB,IAAIkB,oBAAoB;IACxB,IAAIC,gBAAgB;IACpB,IAAIC,gBAAgB;IAEpB,IAAKf,aAAa,EAAG;MACpBa,oBAAoB,GAAGnB,QAAQ,CAACsB,WAAW,CAC1C,kBAAkB,EAClBJ,kBACD,CAAC;MACDE,gBAAgB,GAAGpB,QAAQ,CAACsB,WAAW,CACtC,iBAAiB,EACjBP,iBACD,CAAC;MACDM,gBAAgB,GAAGrB,QAAQ,CAACsB,WAAW,CACtC,iBAAiB,EACjBX,iBACD,CAAC;IACF,CAAC,MAAM;MACNQ,oBAAoB,EAAEI,MAAM,CAAC,CAAC;MAC9BH,gBAAgB,EAAEG,MAAM,CAAC,CAAC;MAC1BF,gBAAgB,EAAEE,MAAM,CAAC,CAAC;IAC3B;IAEA,OAAO,MAAM;MACZX,YAAY,CAAEF,UAAU,CAACG,OAAQ,CAAC;MAClCM,oBAAoB,EAAEI,MAAM,CAAC,CAAC;MAC9BH,gBAAgB,EAAEG,MAAM,CAAC,CAAC;MAC1BF,gBAAgB,EAAEE,MAAM,CAAC,CAAC;IAC3B,CAAC;EACF,CAAC,EAAE,CACFZ,iBAAiB,EACjBI,iBAAiB,EACjBG,kBAAkB,EAClBZ,aAAa,CACZ,CAAC;EACH,OAAO,CAAEE,cAAc,CAAE;AAC1B"}