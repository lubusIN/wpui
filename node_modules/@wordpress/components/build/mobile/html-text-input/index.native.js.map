{"version":3,"names":["_element","require","_reactNative","_i18n","_blocks","_data","_hooks","_compose","_keyboardAvoidingView","_interopRequireDefault","_style","HTMLTextInput","Component","constructor","arguments","edit","bind","stopEditing","getHTMLForParent","addFilter","state","getDerivedStateFromProps","props","isDirty","value","componentWillUnmount","removeFilter","html","onChange","setState","onPersist","render","editTitle","getStylesFromColorScheme","parentHeight","style","title","titleStyle","styles","htmlViewTitle","text","color","htmlStyle","htmlView","htmlViewDark","placeholderStyle","placeholder","placeholderDark","createElement","default","keyboardAvoidingView","ScrollView","scrollView","TextInput","autoCorrect","accessibilityLabel","textAlignVertical","numberOfLines","__","placeholderTextColor","onChangeText","ref","contentTextInputRef","multiline","onBlur","scrollEnabled","rejectResponderTermination","exports","_default","compose","withSelect","select","getEditedPostAttribute","getEditedPostContent","withDispatch","dispatch","editPost","resetEditorBlocks","content","blocks","parse","withInstanceId","withPreferredColorScheme"],"sources":["@wordpress/components/src/mobile/html-text-input/index.native.js"],"sourcesContent":["/**\n * External dependencies\n */\nimport { ScrollView, TextInput } from 'react-native';\n\n/**\n * WordPress dependencies\n */\nimport { Component } from '@wordpress/element';\nimport { __ } from '@wordpress/i18n';\nimport { parse } from '@wordpress/blocks';\nimport { withDispatch, withSelect } from '@wordpress/data';\nimport { addFilter, removeFilter } from '@wordpress/hooks';\nimport {\n\twithInstanceId,\n\tcompose,\n\twithPreferredColorScheme,\n} from '@wordpress/compose';\n\n/**\n * Internal dependencies\n */\nimport KeyboardAvoidingView from '../keyboard-avoiding-view';\nimport styles from './style.scss';\n\nexport class HTMLTextInput extends Component {\n\tconstructor() {\n\t\tsuper( ...arguments );\n\n\t\tthis.edit = this.edit.bind( this );\n\t\tthis.stopEditing = this.stopEditing.bind( this );\n\t\tthis.getHTMLForParent = this.getHTMLForParent.bind( this );\n\t\taddFilter(\n\t\t\t'native.persist-html',\n\t\t\t'html-text-input',\n\t\t\tthis.getHTMLForParent\n\t\t);\n\n\t\tthis.state = {};\n\t}\n\n\tstatic getDerivedStateFromProps( props, state ) {\n\t\tif ( state.isDirty ) {\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\tvalue: props.value,\n\t\t\tisDirty: false,\n\t\t};\n\t}\n\n\tcomponentWillUnmount() {\n\t\tremoveFilter( 'native.persist-html', 'html-text-input' );\n\t\t// TODO: Blocking main thread.\n\t\tthis.stopEditing();\n\t}\n\n\tedit( html ) {\n\t\tthis.props.onChange( html );\n\t\tthis.setState( { value: html, isDirty: true } );\n\t}\n\n\tgetHTMLForParent() {\n\t\treturn this.state.value;\n\t}\n\n\tstopEditing() {\n\t\tif ( this.state.isDirty ) {\n\t\t\tthis.props.onPersist( this.state.value );\n\t\t\tthis.setState( { isDirty: false } );\n\t\t}\n\t}\n\n\trender() {\n\t\tconst {\n\t\t\teditTitle,\n\t\t\tgetStylesFromColorScheme,\n\t\t\tparentHeight,\n\t\t\tstyle,\n\t\t\ttitle,\n\t\t} = this.props;\n\t\tconst titleStyle = [\n\t\t\tstyles.htmlViewTitle,\n\t\t\tstyle?.text && { color: style.text },\n\t\t];\n\t\tconst htmlStyle = [\n\t\t\tgetStylesFromColorScheme( styles.htmlView, styles.htmlViewDark ),\n\t\t\tstyle?.text && { color: style.text },\n\t\t];\n\t\tconst placeholderStyle = {\n\t\t\t...getStylesFromColorScheme(\n\t\t\t\tstyles.placeholder,\n\t\t\t\tstyles.placeholderDark\n\t\t\t),\n\t\t\t...( style?.text && { color: style.text } ),\n\t\t};\n\t\treturn (\n\t\t\t<KeyboardAvoidingView\n\t\t\t\tstyle={ styles.keyboardAvoidingView }\n\t\t\t\tparentHeight={ parentHeight }\n\t\t\t>\n\t\t\t\t<ScrollView style={ styles.scrollView }>\n\t\t\t\t\t<TextInput\n\t\t\t\t\t\tautoCorrect={ false }\n\t\t\t\t\t\taccessibilityLabel=\"html-view-title\"\n\t\t\t\t\t\ttextAlignVertical=\"center\"\n\t\t\t\t\t\tnumberOfLines={ 1 }\n\t\t\t\t\t\tstyle={ titleStyle }\n\t\t\t\t\t\tvalue={ title }\n\t\t\t\t\t\tplaceholder={ __( 'Add title' ) }\n\t\t\t\t\t\tplaceholderTextColor={ placeholderStyle.color }\n\t\t\t\t\t\tonChangeText={ editTitle }\n\t\t\t\t\t/>\n\t\t\t\t\t<TextInput\n\t\t\t\t\t\tref={ this.contentTextInputRef }\n\t\t\t\t\t\tautoCorrect={ false }\n\t\t\t\t\t\taccessibilityLabel=\"html-view-content\"\n\t\t\t\t\t\ttextAlignVertical=\"top\"\n\t\t\t\t\t\tmultiline\n\t\t\t\t\t\tstyle={ htmlStyle }\n\t\t\t\t\t\tvalue={ this.state.value }\n\t\t\t\t\t\tonChangeText={ this.edit }\n\t\t\t\t\t\tonBlur={ this.stopEditing }\n\t\t\t\t\t\tplaceholder={ __( 'Start writingâ€¦' ) }\n\t\t\t\t\t\tplaceholderTextColor={ placeholderStyle.color }\n\t\t\t\t\t\tscrollEnabled={ false }\n\t\t\t\t\t\t// [Only iOS] This prop prevents the text input from\n\t\t\t\t\t\t// automatically getting focused after scrolling\n\t\t\t\t\t\t// content.\n\t\t\t\t\t\trejectResponderTermination={ false }\n\t\t\t\t\t/>\n\t\t\t\t</ScrollView>\n\t\t\t</KeyboardAvoidingView>\n\t\t);\n\t}\n}\n\nexport default compose( [\n\twithSelect( ( select ) => {\n\t\tconst { getEditedPostAttribute, getEditedPostContent } =\n\t\t\tselect( 'core/editor' );\n\n\t\treturn {\n\t\t\ttitle: getEditedPostAttribute( 'title' ),\n\t\t\tvalue: getEditedPostContent(),\n\t\t};\n\t} ),\n\twithDispatch( ( dispatch ) => {\n\t\tconst { editPost, resetEditorBlocks } = dispatch( 'core/editor' );\n\t\treturn {\n\t\t\teditTitle( title ) {\n\t\t\t\teditPost( { title } );\n\t\t\t},\n\t\t\tonChange( content ) {\n\t\t\t\teditPost( { content } );\n\t\t\t},\n\t\t\tonPersist( content ) {\n\t\t\t\tconst blocks = parse( content );\n\t\t\t\tresetEditorBlocks( blocks );\n\t\t\t},\n\t\t};\n\t} ),\n\twithInstanceId,\n\twithPreferredColorScheme,\n] )( HTMLTextInput );\n"],"mappings":"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"}