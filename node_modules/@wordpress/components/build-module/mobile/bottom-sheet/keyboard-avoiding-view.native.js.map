{"version":3,"names":["Keyboard","LayoutAnimation","Platform","StyleSheet","View","Dimensions","Component","KeyboardAvoidingView","constructor","arguments","_onKeyboardChange","bind","_subscriptions","state","bottom","_relativeKeyboardHeight","keyboardFrame","windowWidth","get","width","isFloatingKeyboard","windowHeight","height","keyboardY","screenY","props","keyboardVerticalOffset","final","Math","max","event","setState","duration","easing","endCoordinates","configureNext","update","type","Types","componentDidMount","OS","addListener","componentWillUnmount","forEach","subscription","remove","render","children","enabled","style","finalStyle","bottomHeight","compose","paddingBottom","createElement","defaultProps"],"sources":["@wordpress/components/src/mobile/bottom-sheet/keyboard-avoiding-view.native.js"],"sourcesContent":["/**\n * External dependencies\n */\nimport {\n\tKeyboard,\n\tLayoutAnimation,\n\tPlatform,\n\tStyleSheet,\n\tView,\n\tDimensions,\n} from 'react-native';\n\n/**\n * WordPress dependencies\n */\nimport { Component } from '@wordpress/element';\n\n/**\n * This is a simplified version of Facebook's KeyboardAvoidingView.\n * It's meant to work specifically with BottomSheets.\n * This fixes an issue in the bottom padding calculation, when the\n * BottomSheet was presented on Landscape, with the keyboard already present,\n * and a TextField on Autofocus (situation present on Links UI)\n */\nclass KeyboardAvoidingView extends Component {\n\tconstructor() {\n\t\tsuper( ...arguments );\n\n\t\tthis._onKeyboardChange = this._onKeyboardChange.bind( this );\n\t\tthis._subscriptions = [];\n\t\tthis.state = {\n\t\t\tbottom: 0,\n\t\t};\n\t}\n\n\t_relativeKeyboardHeight( keyboardFrame ) {\n\t\tif ( ! keyboardFrame ) {\n\t\t\treturn 0;\n\t\t}\n\n\t\tconst windowWidth = Dimensions.get( 'window' ).width;\n\t\tconst isFloatingKeyboard = keyboardFrame.width !== windowWidth;\n\t\tif ( isFloatingKeyboard ) {\n\t\t\treturn 0;\n\t\t}\n\n\t\tconst windowHeight = Dimensions.get( 'window' ).height;\n\t\tconst keyboardY =\n\t\t\tkeyboardFrame.screenY - this.props.keyboardVerticalOffset;\n\n\t\tconst final = Math.max( windowHeight - keyboardY, 0 );\n\t\treturn final;\n\t}\n\n\t/**\n\t * @param {Object} event Keyboard event.\n\t */\n\t_onKeyboardChange( event ) {\n\t\tif ( event === null ) {\n\t\t\tthis.setState( { bottom: 0 } );\n\t\t\treturn;\n\t\t}\n\n\t\tconst { duration, easing, endCoordinates } = event;\n\t\tconst height = this._relativeKeyboardHeight( endCoordinates );\n\n\t\tif ( this.state.bottom === height ) {\n\t\t\treturn;\n\t\t}\n\n\t\tif ( duration && easing ) {\n\t\t\tLayoutAnimation.configureNext( {\n\t\t\t\tduration,\n\t\t\t\tupdate: {\n\t\t\t\t\tduration,\n\t\t\t\t\ttype: LayoutAnimation.Types[ easing ] || 'keyboard',\n\t\t\t\t},\n\t\t\t} );\n\t\t}\n\t\tthis.setState( { bottom: height } );\n\t}\n\n\tcomponentDidMount() {\n\t\tif ( Platform.OS === 'ios' ) {\n\t\t\tthis._subscriptions = [\n\t\t\t\tKeyboard.addListener(\n\t\t\t\t\t'keyboardWillChangeFrame',\n\t\t\t\t\tthis._onKeyboardChange\n\t\t\t\t),\n\t\t\t];\n\t\t}\n\t}\n\n\tcomponentWillUnmount() {\n\t\tthis._subscriptions.forEach( ( subscription ) => {\n\t\t\tsubscription.remove();\n\t\t} );\n\t}\n\n\trender() {\n\t\tconst { children, enabled, keyboardVerticalOffset, style, ...props } =\n\t\t\tthis.props;\n\n\t\tlet finalStyle = style;\n\t\tif ( Platform.OS === 'ios' ) {\n\t\t\tconst bottomHeight = enabled ? this.state.bottom : 0;\n\t\t\tfinalStyle = StyleSheet.compose( style, {\n\t\t\t\tpaddingBottom: bottomHeight,\n\t\t\t} );\n\t\t}\n\n\t\treturn (\n\t\t\t<View style={ finalStyle } { ...props }>\n\t\t\t\t{ children }\n\t\t\t</View>\n\t\t);\n\t}\n}\n\nKeyboardAvoidingView.defaultProps = {\n\tenabled: true,\n\tkeyboardVerticalOffset: 0,\n};\n\nexport default KeyboardAvoidingView;\n"],"mappings":"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"}