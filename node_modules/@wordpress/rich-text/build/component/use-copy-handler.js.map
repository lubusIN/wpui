{"version":3,"names":["_element","require","_compose","_toHtmlString","_isCollapsed","_slice","_getTextContent","useCopyHandler","props","propsRef","useRef","current","useRefEffect","element","onCopy","event","record","preserveWhiteSpace","ownerDocument","isCollapsed","contains","activeElement","selectedRecord","slice","plainText","getTextContent","html","toHTMLString","value","clipboardData","setData","preventDefault","type","execCommand","addEventListener","removeEventListener"],"sources":["@wordpress/rich-text/src/component/use-copy-handler.js"],"sourcesContent":["/**\n * WordPress dependencies\n */\nimport { useRef } from '@wordpress/element';\nimport { useRefEffect } from '@wordpress/compose';\n\n/**\n * Internal dependencies\n */\nimport { toHTMLString } from '../to-html-string';\nimport { isCollapsed } from '../is-collapsed';\nimport { slice } from '../slice';\nimport { getTextContent } from '../get-text-content';\n\nexport function useCopyHandler( props ) {\n\tconst propsRef = useRef( props );\n\tpropsRef.current = props;\n\treturn useRefEffect( ( element ) => {\n\t\tfunction onCopy( event ) {\n\t\t\tconst { record, preserveWhiteSpace } = propsRef.current;\n\t\t\tconst { ownerDocument } = element;\n\t\t\tif (\n\t\t\t\tisCollapsed( record.current ) ||\n\t\t\t\t! element.contains( ownerDocument.activeElement )\n\t\t\t) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst selectedRecord = slice( record.current );\n\t\t\tconst plainText = getTextContent( selectedRecord );\n\t\t\tconst html = toHTMLString( {\n\t\t\t\tvalue: selectedRecord,\n\t\t\t\tpreserveWhiteSpace,\n\t\t\t} );\n\t\t\tevent.clipboardData.setData( 'text/plain', plainText );\n\t\t\tevent.clipboardData.setData( 'text/html', html );\n\t\t\tevent.clipboardData.setData( 'rich-text', 'true' );\n\t\t\tevent.preventDefault();\n\n\t\t\tif ( event.type === 'cut' ) {\n\t\t\t\townerDocument.execCommand( 'delete' );\n\t\t\t}\n\t\t}\n\n\t\telement.addEventListener( 'copy', onCopy );\n\t\telement.addEventListener( 'cut', onCopy );\n\t\treturn () => {\n\t\t\telement.removeEventListener( 'copy', onCopy );\n\t\t\telement.removeEventListener( 'cut', onCopy );\n\t\t};\n\t}, [] );\n}\n"],"mappings":";;;;;;AAGA,IAAAA,QAAA,GAAAC,OAAA;AACA,IAAAC,QAAA,GAAAD,OAAA;AAKA,IAAAE,aAAA,GAAAF,OAAA;AACA,IAAAG,YAAA,GAAAH,OAAA;AACA,IAAAI,MAAA,GAAAJ,OAAA;AACA,IAAAK,eAAA,GAAAL,OAAA;AAZA;AACA;AACA;;AAIA;AACA;AACA;;AAMO,SAASM,cAAcA,CAAEC,KAAK,EAAG;EACvC,MAAMC,QAAQ,GAAG,IAAAC,eAAM,EAAEF,KAAM,CAAC;EAChCC,QAAQ,CAACE,OAAO,GAAGH,KAAK;EACxB,OAAO,IAAAI,qBAAY,EAAIC,OAAO,IAAM;IACnC,SAASC,MAAMA,CAAEC,KAAK,EAAG;MACxB,MAAM;QAAEC,MAAM;QAAEC;MAAmB,CAAC,GAAGR,QAAQ,CAACE,OAAO;MACvD,MAAM;QAAEO;MAAc,CAAC,GAAGL,OAAO;MACjC,IACC,IAAAM,wBAAW,EAAEH,MAAM,CAACL,OAAQ,CAAC,IAC7B,CAAEE,OAAO,CAACO,QAAQ,CAAEF,aAAa,CAACG,aAAc,CAAC,EAChD;QACD;MACD;MAEA,MAAMC,cAAc,GAAG,IAAAC,YAAK,EAAEP,MAAM,CAACL,OAAQ,CAAC;MAC9C,MAAMa,SAAS,GAAG,IAAAC,8BAAc,EAAEH,cAAe,CAAC;MAClD,MAAMI,IAAI,GAAG,IAAAC,0BAAY,EAAE;QAC1BC,KAAK,EAAEN,cAAc;QACrBL;MACD,CAAE,CAAC;MACHF,KAAK,CAACc,aAAa,CAACC,OAAO,CAAE,YAAY,EAAEN,SAAU,CAAC;MACtDT,KAAK,CAACc,aAAa,CAACC,OAAO,CAAE,WAAW,EAAEJ,IAAK,CAAC;MAChDX,KAAK,CAACc,aAAa,CAACC,OAAO,CAAE,WAAW,EAAE,MAAO,CAAC;MAClDf,KAAK,CAACgB,cAAc,CAAC,CAAC;MAEtB,IAAKhB,KAAK,CAACiB,IAAI,KAAK,KAAK,EAAG;QAC3Bd,aAAa,CAACe,WAAW,CAAE,QAAS,CAAC;MACtC;IACD;IAEApB,OAAO,CAACqB,gBAAgB,CAAE,MAAM,EAAEpB,MAAO,CAAC;IAC1CD,OAAO,CAACqB,gBAAgB,CAAE,KAAK,EAAEpB,MAAO,CAAC;IACzC,OAAO,MAAM;MACZD,OAAO,CAACsB,mBAAmB,CAAE,MAAM,EAAErB,MAAO,CAAC;MAC7CD,OAAO,CAACsB,mBAAmB,CAAE,KAAK,EAAErB,MAAO,CAAC;IAC7C,CAAC;EACF,CAAC,EAAE,EAAG,CAAC;AACR"}