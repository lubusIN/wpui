{"version":3,"names":["deprecated","createReduxStore","coreDataStore","createEmitter","lock","unlock","getStoreName","storeNameOrDescriptor","name","createRegistry","storeConfigs","parent","stores","emitter","listeningStores","globalListener","emit","subscribe","listener","storeName","store","select","add","getSelectors","__unstableMarkListeningStores","callback","ref","Set","call","current","Array","from","resolveSelect","getResolveSelectors","suspendSelect","getSuspendSelectors","dispatch","getActions","withPlugins","attributes","Object","fromEntries","entries","map","key","attribute","registry","apply","arguments","registerStoreInstance","createStore","console","error","TypeError","currentSubscribe","unsubscribeFromEmitter","unsubscribeFromStore","isPaused","registerPrivateActions","privateActionsOf","registerPrivateSelectors","privateSelectorsOf","e","register","instantiate","registerGenericStore","since","alternative","registerStore","options","reducer","batch","pause","values","forEach","resume","namespaces","use","plugin","config","registryWithPlugins","privateActions","privateSelectors"],"sources":["@wordpress/data/src/registry.js"],"sourcesContent":["/**\n * WordPress dependencies\n */\nimport deprecated from '@wordpress/deprecated';\n\n/**\n * Internal dependencies\n */\nimport createReduxStore from './redux-store';\nimport coreDataStore from './store';\nimport { createEmitter } from './utils/emitter';\nimport { lock, unlock } from './lock-unlock';\n\n/** @typedef {import('./types').StoreDescriptor} StoreDescriptor */\n\n/**\n * @typedef {Object} WPDataRegistry An isolated orchestrator of store registrations.\n *\n * @property {Function} registerGenericStore Given a namespace key and settings\n *                                           object, registers a new generic\n *                                           store.\n * @property {Function} registerStore        Given a namespace key and settings\n *                                           object, registers a new namespace\n *                                           store.\n * @property {Function} subscribe            Given a function callback, invokes\n *                                           the callback on any change to state\n *                                           within any registered store.\n * @property {Function} select               Given a namespace key, returns an\n *                                           object of the  store's registered\n *                                           selectors.\n * @property {Function} dispatch             Given a namespace key, returns an\n *                                           object of the store's registered\n *                                           action dispatchers.\n */\n\n/**\n * @typedef {Object} WPDataPlugin An object of registry function overrides.\n *\n * @property {Function} registerStore registers store.\n */\n\nfunction getStoreName( storeNameOrDescriptor ) {\n\treturn typeof storeNameOrDescriptor === 'string'\n\t\t? storeNameOrDescriptor\n\t\t: storeNameOrDescriptor.name;\n}\n/**\n * Creates a new store registry, given an optional object of initial store\n * configurations.\n *\n * @param {Object}  storeConfigs Initial store configurations.\n * @param {Object?} parent       Parent registry.\n *\n * @return {WPDataRegistry} Data registry.\n */\nexport function createRegistry( storeConfigs = {}, parent = null ) {\n\tconst stores = {};\n\tconst emitter = createEmitter();\n\tlet listeningStores = null;\n\n\t/**\n\t * Global listener called for each store's update.\n\t */\n\tfunction globalListener() {\n\t\temitter.emit();\n\t}\n\n\t/**\n\t * Subscribe to changes to any data, either in all stores in registry, or\n\t * in one specific store.\n\t *\n\t * @param {Function}                listener              Listener function.\n\t * @param {string|StoreDescriptor?} storeNameOrDescriptor Optional store name.\n\t *\n\t * @return {Function} Unsubscribe function.\n\t */\n\tconst subscribe = ( listener, storeNameOrDescriptor ) => {\n\t\t// subscribe to all stores\n\t\tif ( ! storeNameOrDescriptor ) {\n\t\t\treturn emitter.subscribe( listener );\n\t\t}\n\n\t\t// subscribe to one store\n\t\tconst storeName = getStoreName( storeNameOrDescriptor );\n\t\tconst store = stores[ storeName ];\n\t\tif ( store ) {\n\t\t\treturn store.subscribe( listener );\n\t\t}\n\n\t\t// Trying to access a store that hasn't been registered,\n\t\t// this is a pattern rarely used but seen in some places.\n\t\t// We fallback to global `subscribe` here for backward-compatibility for now.\n\t\t// See https://github.com/WordPress/gutenberg/pull/27466 for more info.\n\t\tif ( ! parent ) {\n\t\t\treturn emitter.subscribe( listener );\n\t\t}\n\n\t\treturn parent.subscribe( listener, storeNameOrDescriptor );\n\t};\n\n\t/**\n\t * Calls a selector given the current state and extra arguments.\n\t *\n\t * @param {string|StoreDescriptor} storeNameOrDescriptor Unique namespace identifier for the store\n\t *                                                       or the store descriptor.\n\t *\n\t * @return {*} The selector's returned value.\n\t */\n\tfunction select( storeNameOrDescriptor ) {\n\t\tconst storeName = getStoreName( storeNameOrDescriptor );\n\t\tlisteningStores?.add( storeName );\n\t\tconst store = stores[ storeName ];\n\t\tif ( store ) {\n\t\t\treturn store.getSelectors();\n\t\t}\n\n\t\treturn parent?.select( storeName );\n\t}\n\n\tfunction __unstableMarkListeningStores( callback, ref ) {\n\t\tlisteningStores = new Set();\n\t\ttry {\n\t\t\treturn callback.call( this );\n\t\t} finally {\n\t\t\tref.current = Array.from( listeningStores );\n\t\t\tlisteningStores = null;\n\t\t}\n\t}\n\n\t/**\n\t * Given a store descriptor, returns an object containing the store's selectors pre-bound to\n\t * state so that you only need to supply additional arguments, and modified so that they return\n\t * promises that resolve to their eventual values, after any resolvers have ran.\n\t *\n\t * @param {StoreDescriptor|string} storeNameOrDescriptor The store descriptor. The legacy calling\n\t *                                                       convention of passing the store name is\n\t *                                                       also supported.\n\t *\n\t * @return {Object} Each key of the object matches the name of a selector.\n\t */\n\tfunction resolveSelect( storeNameOrDescriptor ) {\n\t\tconst storeName = getStoreName( storeNameOrDescriptor );\n\t\tlisteningStores?.add( storeName );\n\t\tconst store = stores[ storeName ];\n\t\tif ( store ) {\n\t\t\treturn store.getResolveSelectors();\n\t\t}\n\n\t\treturn parent && parent.resolveSelect( storeName );\n\t}\n\n\t/**\n\t * Given a store descriptor, returns an object containing the store's selectors pre-bound to\n\t * state so that you only need to supply additional arguments, and modified so that they throw\n\t * promises in case the selector is not resolved yet.\n\t *\n\t * @param {StoreDescriptor|string} storeNameOrDescriptor The store descriptor. The legacy calling\n\t *                                                       convention of passing the store name is\n\t *                                                       also supported.\n\t *\n\t * @return {Object} Object containing the store's suspense-wrapped selectors.\n\t */\n\tfunction suspendSelect( storeNameOrDescriptor ) {\n\t\tconst storeName = getStoreName( storeNameOrDescriptor );\n\t\tlisteningStores?.add( storeName );\n\t\tconst store = stores[ storeName ];\n\t\tif ( store ) {\n\t\t\treturn store.getSuspendSelectors();\n\t\t}\n\n\t\treturn parent && parent.suspendSelect( storeName );\n\t}\n\n\t/**\n\t * Returns the available actions for a part of the state.\n\t *\n\t * @param {string|StoreDescriptor} storeNameOrDescriptor Unique namespace identifier for the store\n\t *                                                       or the store descriptor.\n\t *\n\t * @return {*} The action's returned value.\n\t */\n\tfunction dispatch( storeNameOrDescriptor ) {\n\t\tconst storeName = getStoreName( storeNameOrDescriptor );\n\t\tconst store = stores[ storeName ];\n\t\tif ( store ) {\n\t\t\treturn store.getActions();\n\t\t}\n\n\t\treturn parent && parent.dispatch( storeName );\n\t}\n\n\t//\n\t// Deprecated\n\t// TODO: Remove this after `use()` is removed.\n\tfunction withPlugins( attributes ) {\n\t\treturn Object.fromEntries(\n\t\t\tObject.entries( attributes ).map( ( [ key, attribute ] ) => {\n\t\t\t\tif ( typeof attribute !== 'function' ) {\n\t\t\t\t\treturn [ key, attribute ];\n\t\t\t\t}\n\t\t\t\treturn [\n\t\t\t\t\tkey,\n\t\t\t\t\tfunction () {\n\t\t\t\t\t\treturn registry[ key ].apply( null, arguments );\n\t\t\t\t\t},\n\t\t\t\t];\n\t\t\t} )\n\t\t);\n\t}\n\n\t/**\n\t * Registers a store instance.\n\t *\n\t * @param {string}   name        Store registry name.\n\t * @param {Function} createStore Function that creates a store object (getSelectors, getActions, subscribe).\n\t */\n\tfunction registerStoreInstance( name, createStore ) {\n\t\tif ( stores[ name ] ) {\n\t\t\t// eslint-disable-next-line no-console\n\t\t\tconsole.error( 'Store \"' + name + '\" is already registered.' );\n\t\t\treturn stores[ name ];\n\t\t}\n\n\t\tconst store = createStore();\n\n\t\tif ( typeof store.getSelectors !== 'function' ) {\n\t\t\tthrow new TypeError( 'store.getSelectors must be a function' );\n\t\t}\n\t\tif ( typeof store.getActions !== 'function' ) {\n\t\t\tthrow new TypeError( 'store.getActions must be a function' );\n\t\t}\n\t\tif ( typeof store.subscribe !== 'function' ) {\n\t\t\tthrow new TypeError( 'store.subscribe must be a function' );\n\t\t}\n\t\t// The emitter is used to keep track of active listeners when the registry\n\t\t// get paused, that way, when resumed we should be able to call all these\n\t\t// pending listeners.\n\t\tstore.emitter = createEmitter();\n\t\tconst currentSubscribe = store.subscribe;\n\t\tstore.subscribe = ( listener ) => {\n\t\t\tconst unsubscribeFromEmitter = store.emitter.subscribe( listener );\n\t\t\tconst unsubscribeFromStore = currentSubscribe( () => {\n\t\t\t\tif ( store.emitter.isPaused ) {\n\t\t\t\t\tstore.emitter.emit();\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tlistener();\n\t\t\t} );\n\n\t\t\treturn () => {\n\t\t\t\tunsubscribeFromStore?.();\n\t\t\t\tunsubscribeFromEmitter?.();\n\t\t\t};\n\t\t};\n\t\tstores[ name ] = store;\n\t\tstore.subscribe( globalListener );\n\n\t\t// Copy private actions and selectors from the parent store.\n\t\tif ( parent ) {\n\t\t\ttry {\n\t\t\t\tunlock( store.store ).registerPrivateActions(\n\t\t\t\t\tunlock( parent ).privateActionsOf( name )\n\t\t\t\t);\n\t\t\t\tunlock( store.store ).registerPrivateSelectors(\n\t\t\t\t\tunlock( parent ).privateSelectorsOf( name )\n\t\t\t\t);\n\t\t\t} catch ( e ) {\n\t\t\t\t// unlock() throws if store.store was not locked.\n\t\t\t\t// The error indicates there's nothing to do here so let's\n\t\t\t\t// ignore it.\n\t\t\t}\n\t\t}\n\n\t\treturn store;\n\t}\n\n\t/**\n\t * Registers a new store given a store descriptor.\n\t *\n\t * @param {StoreDescriptor} store Store descriptor.\n\t */\n\tfunction register( store ) {\n\t\tregisterStoreInstance( store.name, () =>\n\t\t\tstore.instantiate( registry )\n\t\t);\n\t}\n\n\tfunction registerGenericStore( name, store ) {\n\t\tdeprecated( 'wp.data.registerGenericStore', {\n\t\t\tsince: '5.9',\n\t\t\talternative: 'wp.data.register( storeDescriptor )',\n\t\t} );\n\t\tregisterStoreInstance( name, () => store );\n\t}\n\n\t/**\n\t * Registers a standard `@wordpress/data` store.\n\t *\n\t * @param {string} storeName Unique namespace identifier.\n\t * @param {Object} options   Store description (reducer, actions, selectors, resolvers).\n\t *\n\t * @return {Object} Registered store object.\n\t */\n\tfunction registerStore( storeName, options ) {\n\t\tif ( ! options.reducer ) {\n\t\t\tthrow new TypeError( 'Must specify store reducer' );\n\t\t}\n\n\t\tconst store = registerStoreInstance( storeName, () =>\n\t\t\tcreateReduxStore( storeName, options ).instantiate( registry )\n\t\t);\n\n\t\treturn store.store;\n\t}\n\n\tfunction batch( callback ) {\n\t\t// If we're already batching, just call the callback.\n\t\tif ( emitter.isPaused ) {\n\t\t\tcallback();\n\t\t\treturn;\n\t\t}\n\n\t\temitter.pause();\n\t\tObject.values( stores ).forEach( ( store ) => store.emitter.pause() );\n\t\tcallback();\n\t\temitter.resume();\n\t\tObject.values( stores ).forEach( ( store ) => store.emitter.resume() );\n\t}\n\n\tlet registry = {\n\t\tbatch,\n\t\tstores,\n\t\tnamespaces: stores, // TODO: Deprecate/remove this.\n\t\tsubscribe,\n\t\tselect,\n\t\tresolveSelect,\n\t\tsuspendSelect,\n\t\tdispatch,\n\t\tuse,\n\t\tregister,\n\t\tregisterGenericStore,\n\t\tregisterStore,\n\t\t__unstableMarkListeningStores,\n\t};\n\n\t//\n\t// TODO:\n\t// This function will be deprecated as soon as it is no longer internally referenced.\n\tfunction use( plugin, options ) {\n\t\tif ( ! plugin ) {\n\t\t\treturn;\n\t\t}\n\n\t\tregistry = {\n\t\t\t...registry,\n\t\t\t...plugin( registry, options ),\n\t\t};\n\n\t\treturn registry;\n\t}\n\n\tregistry.register( coreDataStore );\n\n\tfor ( const [ name, config ] of Object.entries( storeConfigs ) ) {\n\t\tregistry.register( createReduxStore( name, config ) );\n\t}\n\n\tif ( parent ) {\n\t\tparent.subscribe( globalListener );\n\t}\n\n\tconst registryWithPlugins = withPlugins( registry );\n\tlock( registryWithPlugins, {\n\t\tprivateActionsOf: ( name ) => {\n\t\t\ttry {\n\t\t\t\treturn unlock( stores[ name ].store ).privateActions;\n\t\t\t} catch ( e ) {\n\t\t\t\t// unlock() throws an error the store was not locked – this means\n\t\t\t\t// there no private actions are available\n\t\t\t\treturn {};\n\t\t\t}\n\t\t},\n\t\tprivateSelectorsOf: ( name ) => {\n\t\t\ttry {\n\t\t\t\treturn unlock( stores[ name ].store ).privateSelectors;\n\t\t\t} catch ( e ) {\n\t\t\t\treturn {};\n\t\t\t}\n\t\t},\n\t} );\n\treturn registryWithPlugins;\n}\n"],"mappings":"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"}