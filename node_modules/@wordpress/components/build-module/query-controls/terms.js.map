{"version":3,"names":["ensureParentsAreDefined","terms","every","term","parent","buildTermsTree","flatTerms","flatTermsWithParentAndChildren","map","children","id","String","termsByParent","reduce","acc","push","fillWithChildren","length"],"sources":["@wordpress/components/src/query-controls/terms.ts"],"sourcesContent":["/**\n * Internal dependencies\n */\nimport type {\n\tAuthor,\n\tCategory,\n\tTermWithParentAndChildren,\n\tTermsByParent,\n} from './types';\n\nconst ensureParentsAreDefined = (\n\tterms: TermWithParentAndChildren[]\n): terms is ( TermWithParentAndChildren & { parent: number } )[] => {\n\treturn terms.every( ( term ) => term.parent !== null );\n};\n/**\n * Returns terms in a tree form.\n *\n * @param flatTerms Array of terms in flat format.\n *\n * @return Terms in tree format.\n */\nexport function buildTermsTree( flatTerms: readonly ( Author | Category )[] ) {\n\tconst flatTermsWithParentAndChildren: TermWithParentAndChildren[] =\n\t\tflatTerms.map( ( term ) => ( {\n\t\t\tchildren: [],\n\t\t\tparent: null,\n\t\t\t...term,\n\t\t\tid: String( term.id ),\n\t\t} ) );\n\n\t// We use a custom type guard here to ensure that the parent property is\n\t// defined on all terms. The type of the `parent` property is `number | null`\n\t// and we need to ensure that it is `number`. This is because we use the\n\t// `parent` property as a key in the `termsByParent` object.\n\tif ( ! ensureParentsAreDefined( flatTermsWithParentAndChildren ) ) {\n\t\treturn flatTermsWithParentAndChildren;\n\t}\n\n\tconst termsByParent = flatTermsWithParentAndChildren.reduce(\n\t\t( acc: TermsByParent, term ) => {\n\t\t\tconst { parent } = term;\n\t\t\tif ( ! acc[ parent ] ) {\n\t\t\t\tacc[ parent ] = [];\n\t\t\t}\n\t\t\tacc[ parent ].push( term );\n\t\t\treturn acc;\n\t\t},\n\t\t{}\n\t);\n\n\tconst fillWithChildren = (\n\t\tterms: TermWithParentAndChildren[]\n\t): TermWithParentAndChildren[] => {\n\t\treturn terms.map( ( term ) => {\n\t\t\tconst children = termsByParent[ term.id ];\n\t\t\treturn {\n\t\t\t\t...term,\n\t\t\t\tchildren:\n\t\t\t\t\tchildren && children.length\n\t\t\t\t\t\t? fillWithChildren( children )\n\t\t\t\t\t\t: [],\n\t\t\t};\n\t\t} );\n\t};\n\n\treturn fillWithChildren( termsByParent[ '0' ] || [] );\n}\n"],"mappings":"AAAA;AACA;AACA;;AAQA,MAAMA,uBAAuB,GAC5BC,KAAkC,IACiC;EACnE,OAAOA,KAAK,CAACC,KAAK,CAAIC,IAAI,IAAMA,IAAI,CAACC,MAAM,KAAK,IAAK,CAAC;AACvD,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO,SAASC,cAAcA,CAAEC,SAA2C,EAAG;EAC7E,MAAMC,8BAA2D,GAChED,SAAS,CAACE,GAAG,CAAIL,IAAI,KAAQ;IAC5BM,QAAQ,EAAE,EAAE;IACZL,MAAM,EAAE,IAAI;IACZ,GAAGD,IAAI;IACPO,EAAE,EAAEC,MAAM,CAAER,IAAI,CAACO,EAAG;EACrB,CAAC,CAAG,CAAC;;EAEN;EACA;EACA;EACA;EACA,IAAK,CAAEV,uBAAuB,CAAEO,8BAA+B,CAAC,EAAG;IAClE,OAAOA,8BAA8B;EACtC;EAEA,MAAMK,aAAa,GAAGL,8BAA8B,CAACM,MAAM,CAC1D,CAAEC,GAAkB,EAAEX,IAAI,KAAM;IAC/B,MAAM;MAAEC;IAAO,CAAC,GAAGD,IAAI;IACvB,IAAK,CAAEW,GAAG,CAAEV,MAAM,CAAE,EAAG;MACtBU,GAAG,CAAEV,MAAM,CAAE,GAAG,EAAE;IACnB;IACAU,GAAG,CAAEV,MAAM,CAAE,CAACW,IAAI,CAAEZ,IAAK,CAAC;IAC1B,OAAOW,GAAG;EACX,CAAC,EACD,CAAC,CACF,CAAC;EAED,MAAME,gBAAgB,GACrBf,KAAkC,IACD;IACjC,OAAOA,KAAK,CAACO,GAAG,CAAIL,IAAI,IAAM;MAC7B,MAAMM,QAAQ,GAAGG,aAAa,CAAET,IAAI,CAACO,EAAE,CAAE;MACzC,OAAO;QACN,GAAGP,IAAI;QACPM,QAAQ,EACPA,QAAQ,IAAIA,QAAQ,CAACQ,MAAM,GACxBD,gBAAgB,CAAEP,QAAS,CAAC,GAC5B;MACL,CAAC;IACF,CAAE,CAAC;EACJ,CAAC;EAED,OAAOO,gBAAgB,CAAEJ,aAAa,CAAE,GAAG,CAAE,IAAI,EAAG,CAAC;AACtD"}