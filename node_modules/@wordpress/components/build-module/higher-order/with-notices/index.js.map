{"version":3,"names":["v4","uuid","forwardRef","useState","useMemo","createHigherOrderComponent","NoticeList","OriginalComponent","Component","props","ref","noticeList","setNoticeList","noticeOperations","createNotice","notice","noticeToAdd","id","current","createErrorNotice","msg","status","content","removeNotice","filter","removeAllNotices","propsOut","noticeUI","length","createElement","className","notices","onRemove","isForwardRef","render"],"sources":["@wordpress/components/src/higher-order/with-notices/index.tsx"],"sourcesContent":["/**\n * External dependencies\n */\nimport { v4 as uuid } from 'uuid';\n\n/**\n * WordPress dependencies\n */\nimport { forwardRef, useState, useMemo } from '@wordpress/element';\nimport { createHigherOrderComponent } from '@wordpress/compose';\n\n/**\n * Internal dependencies\n */\nimport NoticeList from '../../notice/list';\nimport type { WithNoticeProps } from './types';\n\n/**\n * Override the default edit UI to include notices if supported.\n *\n * Wrapping the original component with `withNotices` encapsulates the component\n * with the additional props `noticeOperations` and `noticeUI`.\n *\n * ```jsx\n * import { withNotices, Button } from '@wordpress/components';\n *\n * const MyComponentWithNotices = withNotices(\n * \t( { noticeOperations, noticeUI } ) => {\n * \t\tconst addError = () =>\n * \t\t\tnoticeOperations.createErrorNotice( 'Error message' );\n * \t\treturn (\n * \t\t\t<div>\n * \t\t\t\t{ noticeUI }\n * \t\t\t\t<Button variant=\"secondary\" onClick={ addError }>\n * \t\t\t\t\tAdd error\n * \t\t\t\t</Button>\n * \t\t\t</div>\n * \t\t);\n * \t}\n * );\n * ```\n *\n * @param OriginalComponent Original component.\n *\n * @return Wrapped component.\n */\nexport default createHigherOrderComponent( ( OriginalComponent ) => {\n\tfunction Component(\n\t\tprops: { [ key: string ]: any },\n\t\tref: React.ForwardedRef< any >\n\t) {\n\t\tconst [ noticeList, setNoticeList ] = useState<\n\t\t\tWithNoticeProps[ 'noticeList' ]\n\t\t>( [] );\n\n\t\tconst noticeOperations = useMemo<\n\t\t\tWithNoticeProps[ 'noticeOperations' ]\n\t\t>( () => {\n\t\t\tconst createNotice: WithNoticeProps[ 'noticeOperations' ][ 'createNotice' ] =\n\t\t\t\t( notice ) => {\n\t\t\t\t\tconst noticeToAdd = notice.id\n\t\t\t\t\t\t? notice\n\t\t\t\t\t\t: { ...notice, id: uuid() };\n\t\t\t\t\tsetNoticeList( ( current ) => [ ...current, noticeToAdd ] );\n\t\t\t\t};\n\n\t\t\treturn {\n\t\t\t\tcreateNotice,\n\t\t\t\tcreateErrorNotice: ( msg ) => {\n\t\t\t\t\t// @ts-expect-error TODO: Missing `id`, potentially a bug\n\t\t\t\t\tcreateNotice( {\n\t\t\t\t\t\tstatus: 'error',\n\t\t\t\t\t\tcontent: msg,\n\t\t\t\t\t} );\n\t\t\t\t},\n\t\t\t\tremoveNotice: ( id ) => {\n\t\t\t\t\tsetNoticeList( ( current ) =>\n\t\t\t\t\t\tcurrent.filter( ( notice ) => notice.id !== id )\n\t\t\t\t\t);\n\t\t\t\t},\n\t\t\t\tremoveAllNotices: () => {\n\t\t\t\t\tsetNoticeList( [] );\n\t\t\t\t},\n\t\t\t};\n\t\t}, [] );\n\n\t\tconst propsOut = {\n\t\t\t...props,\n\t\t\tnoticeList,\n\t\t\tnoticeOperations,\n\t\t\tnoticeUI: noticeList.length > 0 && (\n\t\t\t\t<NoticeList\n\t\t\t\t\tclassName=\"components-with-notices-ui\"\n\t\t\t\t\tnotices={ noticeList }\n\t\t\t\t\tonRemove={ noticeOperations.removeNotice }\n\t\t\t\t/>\n\t\t\t),\n\t\t};\n\n\t\treturn isForwardRef ? (\n\t\t\t<OriginalComponent { ...propsOut } ref={ ref } />\n\t\t) : (\n\t\t\t<OriginalComponent { ...propsOut } />\n\t\t);\n\t}\n\n\tlet isForwardRef: boolean;\n\t// @ts-expect-error - `render` will only be present when OriginalComponent was wrapped with forwardRef().\n\tconst { render } = OriginalComponent;\n\t// Returns a forwardRef if OriginalComponent appears to be a forwardRef.\n\tif ( typeof render === 'function' ) {\n\t\tisForwardRef = true;\n\t\treturn forwardRef( Component );\n\t}\n\treturn Component;\n}, 'withNotices' );\n"],"mappings":";AAAA;AACA;AACA;AACA,SAASA,EAAE,IAAIC,IAAI,QAAQ,MAAM;;AAEjC;AACA;AACA;AACA,SAASC,UAAU,EAAEC,QAAQ,EAAEC,OAAO,QAAQ,oBAAoB;AAClE,SAASC,0BAA0B,QAAQ,oBAAoB;;AAE/D;AACA;AACA;AACA,OAAOC,UAAU,MAAM,mBAAmB;AAG1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAeD,0BAA0B,CAAIE,iBAAiB,IAAM;EACnE,SAASC,SAASA,CACjBC,KAA+B,EAC/BC,GAA8B,EAC7B;IACD,MAAM,CAAEC,UAAU,EAAEC,aAAa,CAAE,GAAGT,QAAQ,CAE3C,EAAG,CAAC;IAEP,MAAMU,gBAAgB,GAAGT,OAAO,CAE7B,MAAM;MACR,MAAMU,YAAqE,GACxEC,MAAM,IAAM;QACb,MAAMC,WAAW,GAAGD,MAAM,CAACE,EAAE,GAC1BF,MAAM,GACN;UAAE,GAAGA,MAAM;UAAEE,EAAE,EAAEhB,IAAI,CAAC;QAAE,CAAC;QAC5BW,aAAa,CAAIM,OAAO,IAAM,CAAE,GAAGA,OAAO,EAAEF,WAAW,CAAG,CAAC;MAC5D,CAAC;MAEF,OAAO;QACNF,YAAY;QACZK,iBAAiB,EAAIC,GAAG,IAAM;UAC7B;UACAN,YAAY,CAAE;YACbO,MAAM,EAAE,OAAO;YACfC,OAAO,EAAEF;UACV,CAAE,CAAC;QACJ,CAAC;QACDG,YAAY,EAAIN,EAAE,IAAM;UACvBL,aAAa,CAAIM,OAAO,IACvBA,OAAO,CAACM,MAAM,CAAIT,MAAM,IAAMA,MAAM,CAACE,EAAE,KAAKA,EAAG,CAChD,CAAC;QACF,CAAC;QACDQ,gBAAgB,EAAEA,CAAA,KAAM;UACvBb,aAAa,CAAE,EAAG,CAAC;QACpB;MACD,CAAC;IACF,CAAC,EAAE,EAAG,CAAC;IAEP,MAAMc,QAAQ,GAAG;MAChB,GAAGjB,KAAK;MACRE,UAAU;MACVE,gBAAgB;MAChBc,QAAQ,EAAEhB,UAAU,CAACiB,MAAM,GAAG,CAAC,IAC9BC,aAAA,CAACvB,UAAU;QACVwB,SAAS,EAAC,4BAA4B;QACtCC,OAAO,EAAGpB,UAAY;QACtBqB,QAAQ,EAAGnB,gBAAgB,CAACU;MAAc,CAC1C;IAEH,CAAC;IAED,OAAOU,YAAY,GAClBJ,aAAA,CAACtB,iBAAiB;MAAA,GAAMmB,QAAQ;MAAGhB,GAAG,EAAGA;IAAK,CAAE,CAAC,GAEjDmB,aAAA,CAACtB,iBAAiB;MAAA,GAAMmB;IAAQ,CAAI,CACpC;EACF;EAEA,IAAIO,YAAqB;EACzB;EACA,MAAM;IAAEC;EAAO,CAAC,GAAG3B,iBAAiB;EACpC;EACA,IAAK,OAAO2B,MAAM,KAAK,UAAU,EAAG;IACnCD,YAAY,GAAG,IAAI;IACnB,OAAO/B,UAAU,CAAEM,SAAU,CAAC;EAC/B;EACA,OAAOA,SAAS;AACjB,CAAC,EAAE,aAAc,CAAC"}