{"version":3,"names":["useRef","useRefEffect","BACKSPACE","DELETE","remove","useDelete","props","propsRef","current","element","onKeyDown","event","keyCode","createRecord","handleChange","defaultPrevented","currentValue","start","end","text","length","preventDefault","addEventListener","removeEventListener"],"sources":["@wordpress/rich-text/src/component/use-delete.js"],"sourcesContent":["/**\n * WordPress dependencies\n */\nimport { useRef } from '@wordpress/element';\nimport { useRefEffect } from '@wordpress/compose';\nimport { BACKSPACE, DELETE } from '@wordpress/keycodes';\n\n/**\n * Internal dependencies\n */\nimport { remove } from '../remove';\n\nexport function useDelete( props ) {\n\tconst propsRef = useRef( props );\n\tpropsRef.current = props;\n\treturn useRefEffect( ( element ) => {\n\t\tfunction onKeyDown( event ) {\n\t\t\tconst { keyCode } = event;\n\t\t\tconst { createRecord, handleChange } = propsRef.current;\n\n\t\t\tif ( event.defaultPrevented ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif ( keyCode !== DELETE && keyCode !== BACKSPACE ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst currentValue = createRecord();\n\t\t\tconst { start, end, text } = currentValue;\n\n\t\t\t// Always handle full content deletion ourselves.\n\t\t\tif ( start === 0 && end !== 0 && end === text.length ) {\n\t\t\t\thandleChange( remove( currentValue ) );\n\t\t\t\tevent.preventDefault();\n\t\t\t}\n\t\t}\n\n\t\telement.addEventListener( 'keydown', onKeyDown );\n\t\treturn () => {\n\t\t\telement.removeEventListener( 'keydown', onKeyDown );\n\t\t};\n\t}, [] );\n}\n"],"mappings":"AAAA;AACA;AACA;AACA,SAASA,MAAM,QAAQ,oBAAoB;AAC3C,SAASC,YAAY,QAAQ,oBAAoB;AACjD,SAASC,SAAS,EAAEC,MAAM,QAAQ,qBAAqB;;AAEvD;AACA;AACA;AACA,SAASC,MAAM,QAAQ,WAAW;AAElC,OAAO,SAASC,SAASA,CAAEC,KAAK,EAAG;EAClC,MAAMC,QAAQ,GAAGP,MAAM,CAAEM,KAAM,CAAC;EAChCC,QAAQ,CAACC,OAAO,GAAGF,KAAK;EACxB,OAAOL,YAAY,CAAIQ,OAAO,IAAM;IACnC,SAASC,SAASA,CAAEC,KAAK,EAAG;MAC3B,MAAM;QAAEC;MAAQ,CAAC,GAAGD,KAAK;MACzB,MAAM;QAAEE,YAAY;QAAEC;MAAa,CAAC,GAAGP,QAAQ,CAACC,OAAO;MAEvD,IAAKG,KAAK,CAACI,gBAAgB,EAAG;QAC7B;MACD;MAEA,IAAKH,OAAO,KAAKT,MAAM,IAAIS,OAAO,KAAKV,SAAS,EAAG;QAClD;MACD;MAEA,MAAMc,YAAY,GAAGH,YAAY,CAAC,CAAC;MACnC,MAAM;QAAEI,KAAK;QAAEC,GAAG;QAAEC;MAAK,CAAC,GAAGH,YAAY;;MAEzC;MACA,IAAKC,KAAK,KAAK,CAAC,IAAIC,GAAG,KAAK,CAAC,IAAIA,GAAG,KAAKC,IAAI,CAACC,MAAM,EAAG;QACtDN,YAAY,CAAEV,MAAM,CAAEY,YAAa,CAAE,CAAC;QACtCL,KAAK,CAACU,cAAc,CAAC,CAAC;MACvB;IACD;IAEAZ,OAAO,CAACa,gBAAgB,CAAE,SAAS,EAAEZ,SAAU,CAAC;IAChD,OAAO,MAAM;MACZD,OAAO,CAACc,mBAAmB,CAAE,SAAS,EAAEb,SAAU,CAAC;IACpD,CAAC;EACF,CAAC,EAAE,EAAG,CAAC;AACR"}