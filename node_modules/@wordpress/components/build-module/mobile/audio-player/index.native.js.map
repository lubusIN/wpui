{"version":3,"names":["Text","TouchableWithoutFeedback","Linking","Alert","Platform","default","VideoPlayer","View","Icon","withPreferredColorScheme","__","audio","warning","requestImageFailedRetryDialog","requestImageUploadCancelDialog","getProtocol","useState","styles","parseAudioUrl","isIOS","OS","Player","getStylesFromColorScheme","isUploadInProgress","isUploadFailed","attributes","isSelected","id","src","paused","setPaused","onPressListen","player","presentFullscreenPlayer","canOpenURL","then","supported","alert","openURL","catch","containerStyle","container","containerDark","iconStyle","icon","iconDark","iconDisabledStyle","iconDisabled","iconDisabledDark","isDisabled","finalIconStyle","iconContainerStyle","iconContainer","iconContainerDark","titleContainerStyle","titleContainer","titleContainerIOS","titleContainerAndroid","titleStyle","title","titleDark","uploadFailedStyle","uploadFailed","uploadFailedDark","subtitleStyle","subtitle","subtitleDark","finalSubtitleStyle","buttonBackgroundStyle","buttonBackground","buttonBackgroundDark","extension","result","getSubtitleValue","onAudioUploadCancelDialog","createElement","accessible","disabled","onPress","style","size","subtitleContainer","errorIcon","accessibilityLabel","accessibilityRole","accessibilityHint","buttonText","source","uri","ref","controls","ignoreSilentSwitch","onFullscreenPlayerWillPresent","onFullscreenPlayerDidDismiss"],"sources":["@wordpress/components/src/mobile/audio-player/index.native.js"],"sourcesContent":["/**\n * External dependencies\n */\nimport {\n\tText,\n\tTouchableWithoutFeedback,\n\tLinking,\n\tAlert,\n\tPlatform,\n} from 'react-native';\nimport { default as VideoPlayer } from 'react-native-video';\n\n/**\n * WordPress dependencies\n */\nimport { View } from '@wordpress/primitives';\nimport { Icon } from '@wordpress/components';\nimport { withPreferredColorScheme } from '@wordpress/compose';\nimport { __ } from '@wordpress/i18n';\nimport { audio, warning } from '@wordpress/icons';\nimport {\n\trequestImageFailedRetryDialog,\n\trequestImageUploadCancelDialog,\n} from '@wordpress/react-native-bridge';\nimport { getProtocol } from '@wordpress/url';\nimport { useState } from '@wordpress/element';\n\n/**\n * Internal dependencies\n */\nimport styles from './styles.scss';\nimport { parseAudioUrl } from './audio-url-parser.native';\n\nconst isIOS = Platform.OS === 'ios';\n\nfunction Player( {\n\tgetStylesFromColorScheme,\n\tisUploadInProgress,\n\tisUploadFailed,\n\tattributes,\n\tisSelected,\n} ) {\n\tconst { id, src } = attributes;\n\tconst [ paused, setPaused ] = useState( true );\n\n\tconst onPressListen = () => {\n\t\tif ( src ) {\n\t\t\tif ( isIOS && this.player ) {\n\t\t\t\tthis.player.presentFullscreenPlayer();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tLinking.canOpenURL( src )\n\t\t\t\t.then( ( supported ) => {\n\t\t\t\t\tif ( ! supported ) {\n\t\t\t\t\t\tAlert.alert(\n\t\t\t\t\t\t\t__( 'Problem opening the audio' ),\n\t\t\t\t\t\t\t__( 'No application can handle this request.' )\n\t\t\t\t\t\t);\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn Linking.openURL( src );\n\t\t\t\t\t}\n\t\t\t\t} )\n\t\t\t\t.catch( () => {\n\t\t\t\t\tAlert.alert(\n\t\t\t\t\t\t__( 'Problem opening the audio' ),\n\t\t\t\t\t\t__( 'An unknown error occurred. Please try again.' )\n\t\t\t\t\t);\n\t\t\t\t} );\n\t\t}\n\t};\n\n\tconst containerStyle = getStylesFromColorScheme(\n\t\tstyles.container,\n\t\tstyles.containerDark\n\t);\n\n\tconst iconStyle = getStylesFromColorScheme( styles.icon, styles.iconDark );\n\n\tconst iconDisabledStyle = getStylesFromColorScheme(\n\t\tstyles.iconDisabled,\n\t\tstyles.iconDisabledDark\n\t);\n\n\tconst isDisabled = isUploadFailed || isUploadInProgress;\n\n\tconst finalIconStyle = {\n\t\t...iconStyle,\n\t\t...( isDisabled && iconDisabledStyle ),\n\t};\n\n\tconst iconContainerStyle = getStylesFromColorScheme(\n\t\tstyles.iconContainer,\n\t\tstyles.iconContainerDark\n\t);\n\n\tconst titleContainerStyle = {\n\t\t...styles.titleContainer,\n\t\t...( isIOS ? styles.titleContainerIOS : styles.titleContainerAndroid ),\n\t};\n\n\tconst titleStyle = getStylesFromColorScheme(\n\t\tstyles.title,\n\t\tstyles.titleDark\n\t);\n\n\tconst uploadFailedStyle = getStylesFromColorScheme(\n\t\tstyles.uploadFailed,\n\t\tstyles.uploadFailedDark\n\t);\n\n\tconst subtitleStyle = getStylesFromColorScheme(\n\t\tstyles.subtitle,\n\t\tstyles.subtitleDark\n\t);\n\n\tconst finalSubtitleStyle = {\n\t\t...subtitleStyle,\n\t\t...( isUploadFailed && uploadFailedStyle ),\n\t};\n\n\tconst buttonBackgroundStyle = getStylesFromColorScheme(\n\t\tstyles.buttonBackground,\n\t\tstyles.buttonBackgroundDark\n\t);\n\n\tlet title = '';\n\tlet extension = '';\n\n\tif ( src ) {\n\t\tconst result = parseAudioUrl( src );\n\t\textension = result.extension;\n\t\ttitle = result.title;\n\t}\n\n\tconst getSubtitleValue = () => {\n\t\tif ( isUploadInProgress ) {\n\t\t\treturn __( 'Uploadingâ€¦' );\n\t\t}\n\t\tif ( isUploadFailed ) {\n\t\t\treturn __( 'Failed to insert audio file. Please tap for options.' );\n\t\t}\n\t\treturn (\n\t\t\textension +\n\t\t\t// translators: displays audio file extension. e.g. MP3 audio file\n\t\t\t__( 'audio file' )\n\t\t);\n\t};\n\n\tfunction onAudioUploadCancelDialog() {\n\t\tif ( isUploadInProgress ) {\n\t\t\trequestImageUploadCancelDialog( id );\n\t\t} else if ( id && getProtocol( src ) === 'file:' ) {\n\t\t\trequestImageFailedRetryDialog( id );\n\t\t}\n\t}\n\n\treturn (\n\t\t<TouchableWithoutFeedback\n\t\t\taccessible={ ! isSelected }\n\t\t\tdisabled={ ! isSelected }\n\t\t\tonPress={ onAudioUploadCancelDialog }\n\t\t>\n\t\t\t<View style={ containerStyle }>\n\t\t\t\t<View style={ iconContainerStyle }>\n\t\t\t\t\t<Icon icon={ audio } style={ finalIconStyle } size={ 24 } />\n\t\t\t\t</View>\n\t\t\t\t<View style={ titleContainerStyle }>\n\t\t\t\t\t<Text style={ titleStyle }>{ title }</Text>\n\t\t\t\t\t<View style={ styles.subtitleContainer }>\n\t\t\t\t\t\t{ isUploadFailed && (\n\t\t\t\t\t\t\t<Icon\n\t\t\t\t\t\t\t\ticon={ warning }\n\t\t\t\t\t\t\t\tstyle={ {\n\t\t\t\t\t\t\t\t\t...styles.errorIcon,\n\t\t\t\t\t\t\t\t\t...uploadFailedStyle,\n\t\t\t\t\t\t\t\t} }\n\t\t\t\t\t\t\t\tsize={ 16 }\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t) }\n\t\t\t\t\t\t<Text style={ finalSubtitleStyle }>\n\t\t\t\t\t\t\t{ getSubtitleValue() }\n\t\t\t\t\t\t</Text>\n\t\t\t\t\t</View>\n\t\t\t\t</View>\n\t\t\t\t{ ! isDisabled && (\n\t\t\t\t\t<TouchableWithoutFeedback\n\t\t\t\t\t\taccessibilityLabel={ __( 'Audio Player' ) }\n\t\t\t\t\t\taccessibilityRole={ 'button' }\n\t\t\t\t\t\taccessibilityHint={ __(\n\t\t\t\t\t\t\t'Double tap to listen the audio file'\n\t\t\t\t\t\t) }\n\t\t\t\t\t\tonPress={ onPressListen }\n\t\t\t\t\t>\n\t\t\t\t\t\t<View style={ buttonBackgroundStyle }>\n\t\t\t\t\t\t\t<Text style={ styles.buttonText }>\n\t\t\t\t\t\t\t\t{ __( 'OPEN' ) }\n\t\t\t\t\t\t\t</Text>\n\t\t\t\t\t\t</View>\n\t\t\t\t\t</TouchableWithoutFeedback>\n\t\t\t\t) }\n\t\t\t\t{ isIOS && (\n\t\t\t\t\t<VideoPlayer\n\t\t\t\t\t\tsource={ { uri: src } }\n\t\t\t\t\t\tpaused={ paused }\n\t\t\t\t\t\tref={ ( ref ) => {\n\t\t\t\t\t\t\tthis.player = ref;\n\t\t\t\t\t\t} }\n\t\t\t\t\t\tcontrols={ false }\n\t\t\t\t\t\tignoreSilentSwitch={ 'ignore' }\n\t\t\t\t\t\tonFullscreenPlayerWillPresent={ () => {\n\t\t\t\t\t\t\tsetPaused( false );\n\t\t\t\t\t\t} }\n\t\t\t\t\t\tonFullscreenPlayerDidDismiss={ () => {\n\t\t\t\t\t\t\tsetPaused( true );\n\t\t\t\t\t\t} }\n\t\t\t\t\t/>\n\t\t\t\t) }\n\t\t\t</View>\n\t\t</TouchableWithoutFeedback>\n\t);\n}\n\nexport default withPreferredColorScheme( Player );\n"],"mappings":"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"}