{"version":3,"names":["POSITION_TO_PLACEMENT","bottom","top","middle","positionToPlacement","position","_POSITION_TO_PLACEMEN","exports","PLACEMENT_TO_ANIMATION_ORIGIN","originX","originY","right","left","overlay","placementToMotionAnimationProps","placement","translateProp","startsWith","translateDirection","style","initial","opacity","scale","animate","transition","duration","ease","isTopBottom","anchorRef","isRef","current","getReferenceElement","anchor","anchorRect","getAnchorRect","fallbackReferenceElement","_referenceElement","referenceElement","getBoundingClientRect","topRect","bottomRect","window","DOMRect","x","y","width","_rect$x","_rect$y","_rect$width","_rect$height","rect","height","parentElement","computePopoverPosition","c","Number","isNaN","undefined","Math","round"],"sources":["@wordpress/components/src/popover/utils.ts"],"sourcesContent":["/**\n * External dependencies\n */\n// eslint-disable-next-line no-restricted-imports\nimport type { MotionProps } from 'framer-motion';\nimport type { Placement, ReferenceType } from '@floating-ui/react-dom';\n\n/**\n * Internal dependencies\n */\nimport type {\n\tPopoverProps,\n\tPopoverAnchorRefReference,\n\tPopoverAnchorRefTopBottom,\n} from './types';\n\nconst POSITION_TO_PLACEMENT: Record<\n\tNonNullable< PopoverProps[ 'position' ] >,\n\tPlacement\n> = {\n\tbottom: 'bottom',\n\ttop: 'top',\n\t'middle left': 'left',\n\t'middle right': 'right',\n\t'bottom left': 'bottom-end',\n\t'bottom center': 'bottom',\n\t'bottom right': 'bottom-start',\n\t'top left': 'top-end',\n\t'top center': 'top',\n\t'top right': 'top-start',\n\t'middle left left': 'left',\n\t'middle left right': 'left',\n\t'middle left bottom': 'left-end',\n\t'middle left top': 'left-start',\n\t'middle right left': 'right',\n\t'middle right right': 'right',\n\t'middle right bottom': 'right-end',\n\t'middle right top': 'right-start',\n\t'bottom left left': 'bottom-end',\n\t'bottom left right': 'bottom-end',\n\t'bottom left bottom': 'bottom-end',\n\t'bottom left top': 'bottom-end',\n\t'bottom center left': 'bottom',\n\t'bottom center right': 'bottom',\n\t'bottom center bottom': 'bottom',\n\t'bottom center top': 'bottom',\n\t'bottom right left': 'bottom-start',\n\t'bottom right right': 'bottom-start',\n\t'bottom right bottom': 'bottom-start',\n\t'bottom right top': 'bottom-start',\n\t'top left left': 'top-end',\n\t'top left right': 'top-end',\n\t'top left bottom': 'top-end',\n\t'top left top': 'top-end',\n\t'top center left': 'top',\n\t'top center right': 'top',\n\t'top center bottom': 'top',\n\t'top center top': 'top',\n\t'top right left': 'top-start',\n\t'top right right': 'top-start',\n\t'top right bottom': 'top-start',\n\t'top right top': 'top-start',\n\t// `middle`/`middle center [corner?]` positions are associated to a fallback\n\t// `bottom` placement because there aren't any corresponding placement values.\n\tmiddle: 'bottom',\n\t'middle center': 'bottom',\n\t'middle center bottom': 'bottom',\n\t'middle center left': 'bottom',\n\t'middle center right': 'bottom',\n\t'middle center top': 'bottom',\n};\n\n/**\n * Converts the `Popover`'s legacy \"position\" prop to the new \"placement\" prop\n * (used by `floating-ui`).\n *\n * @param position The legacy position\n * @return The corresponding placement\n */\nexport const positionToPlacement = (\n\tposition: NonNullable< PopoverProps[ 'position' ] >\n) => POSITION_TO_PLACEMENT[ position ] ?? 'bottom';\n\n/**\n * @typedef AnimationOrigin\n * @type {Object}\n * @property {number} originX A number between 0 and 1 (in CSS logical properties jargon, 0 is \"start\", 0.5 is \"center\", and 1 is \"end\")\n * @property {number} originY A number between 0 and 1 (0 is top, 0.5 is center, and 1 is bottom)\n */\n\nconst PLACEMENT_TO_ANIMATION_ORIGIN: Record<\n\tNonNullable< PopoverProps[ 'placement' ] >,\n\t{ originX: number; originY: number }\n> = {\n\ttop: { originX: 0.5, originY: 1 }, // open from bottom, center\n\t'top-start': { originX: 0, originY: 1 }, // open from bottom, left\n\t'top-end': { originX: 1, originY: 1 }, // open from bottom, right\n\tright: { originX: 0, originY: 0.5 }, // open from middle, left\n\t'right-start': { originX: 0, originY: 0 }, // open from top, left\n\t'right-end': { originX: 0, originY: 1 }, // open from bottom, left\n\tbottom: { originX: 0.5, originY: 0 }, // open from top, center\n\t'bottom-start': { originX: 0, originY: 0 }, // open from top, left\n\t'bottom-end': { originX: 1, originY: 0 }, // open from top, right\n\tleft: { originX: 1, originY: 0.5 }, // open from middle, right\n\t'left-start': { originX: 1, originY: 0 }, // open from top, right\n\t'left-end': { originX: 1, originY: 1 }, // open from bottom, right\n\toverlay: { originX: 0.5, originY: 0.5 }, // open from center, center\n};\n\n/**\n * Given the floating-ui `placement`, compute the framer-motion props for the\n * popover's entry animation.\n *\n * @param placement A placement string from floating ui\n * @return The object containing the motion props\n */\nexport const placementToMotionAnimationProps = (\n\tplacement: NonNullable< PopoverProps[ 'placement' ] >\n): MotionProps => {\n\tconst translateProp =\n\t\tplacement.startsWith( 'top' ) || placement.startsWith( 'bottom' )\n\t\t\t? 'translateY'\n\t\t\t: 'translateX';\n\tconst translateDirection =\n\t\tplacement.startsWith( 'top' ) || placement.startsWith( 'left' )\n\t\t\t? 1\n\t\t\t: -1;\n\n\treturn {\n\t\tstyle: PLACEMENT_TO_ANIMATION_ORIGIN[ placement ],\n\t\tinitial: {\n\t\t\topacity: 0,\n\t\t\tscale: 0,\n\t\t\t[ translateProp ]: `${ 2 * translateDirection }em`,\n\t\t},\n\t\tanimate: { opacity: 1, scale: 1, [ translateProp ]: 0 },\n\t\ttransition: { duration: 0.1, ease: [ 0, 0, 0.2, 1 ] },\n\t};\n};\n\nfunction isTopBottom(\n\tanchorRef: PopoverProps[ 'anchorRef' ]\n): anchorRef is PopoverAnchorRefTopBottom {\n\treturn !! ( anchorRef as PopoverAnchorRefTopBottom )?.top;\n}\n\nfunction isRef(\n\tanchorRef: PopoverProps[ 'anchorRef' ]\n): anchorRef is PopoverAnchorRefReference {\n\treturn !! ( anchorRef as PopoverAnchorRefReference )?.current;\n}\n\nexport const getReferenceElement = ( {\n\tanchor,\n\tanchorRef,\n\tanchorRect,\n\tgetAnchorRect,\n\tfallbackReferenceElement,\n}: Pick<\n\tPopoverProps,\n\t'anchorRef' | 'anchorRect' | 'getAnchorRect' | 'anchor'\n> & {\n\tfallbackReferenceElement: Element | null;\n} ): ReferenceType | null => {\n\tlet referenceElement = null;\n\n\tif ( anchor ) {\n\t\treferenceElement = anchor;\n\t} else if ( isTopBottom( anchorRef ) ) {\n\t\t// Create a virtual element for the ref. The expectation is that\n\t\t// if anchorRef.top is defined, then anchorRef.bottom is defined too.\n\t\t// Seems to be used by the block toolbar, when multiple blocks are selected\n\t\t// (top and bottom blocks are used to calculate the resulting rect).\n\t\treferenceElement = {\n\t\t\tgetBoundingClientRect() {\n\t\t\t\tconst topRect = anchorRef.top.getBoundingClientRect();\n\t\t\t\tconst bottomRect = anchorRef.bottom.getBoundingClientRect();\n\t\t\t\treturn new window.DOMRect(\n\t\t\t\t\ttopRect.x,\n\t\t\t\t\ttopRect.y,\n\t\t\t\t\ttopRect.width,\n\t\t\t\t\tbottomRect.bottom - topRect.top\n\t\t\t\t);\n\t\t\t},\n\t\t};\n\t} else if ( isRef( anchorRef ) ) {\n\t\t// Standard React ref.\n\t\treferenceElement = anchorRef.current;\n\t} else if ( anchorRef ) {\n\t\t// If `anchorRef` holds directly the element's value (no `current` key)\n\t\t// This is a weird scenario and should be deprecated.\n\t\treferenceElement = anchorRef as Element;\n\t} else if ( anchorRect ) {\n\t\t// Create a virtual element for the ref.\n\t\treferenceElement = {\n\t\t\tgetBoundingClientRect() {\n\t\t\t\treturn anchorRect;\n\t\t\t},\n\t\t};\n\t} else if ( getAnchorRect ) {\n\t\t// Create a virtual element for the ref.\n\t\treferenceElement = {\n\t\t\tgetBoundingClientRect() {\n\t\t\t\tconst rect = getAnchorRect( fallbackReferenceElement );\n\t\t\t\treturn new window.DOMRect(\n\t\t\t\t\trect.x ?? rect.left,\n\t\t\t\t\trect.y ?? rect.top,\n\t\t\t\t\trect.width ?? rect.right - rect.left,\n\t\t\t\t\trect.height ?? rect.bottom - rect.top\n\t\t\t\t);\n\t\t\t},\n\t\t};\n\t} else if ( fallbackReferenceElement ) {\n\t\t// If no explicit ref is passed via props, fall back to\n\t\t// anchoring to the popover's parent node.\n\t\treferenceElement = fallbackReferenceElement.parentElement;\n\t}\n\n\t// Convert any `undefined` value to `null`.\n\treturn referenceElement ?? null;\n};\n\n/**\n * Computes the final coordinate that needs to be applied to the floating\n * element when applying transform inline styles, defaulting to `undefined`\n * if the provided value is `null` or `NaN`.\n *\n * @param c input coordinate (usually as returned from floating-ui)\n * @return The coordinate's value to be used for inline styles. An `undefined`\n *         return value means \"no style set\" for this coordinate.\n */\nexport const computePopoverPosition = ( c: number | null ) =>\n\tc === null || Number.isNaN( c ) ? undefined : Math.round( c );\n"],"mappings":"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"}