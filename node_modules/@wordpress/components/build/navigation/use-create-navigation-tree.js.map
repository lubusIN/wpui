{"version":3,"names":["_element","require","_useNavigationTreeNodes","useCreateNavigationTree","nodes","items","getNode","getItem","addNode","addItem","removeNode","removeItem","useNavigationTreeNodes","menus","getMenu","addMenu","removeMenu","childMenu","setChildMenu","useState","getChildMenu","menu","traverseMenu","startMenu","callback","visited","queue","current","length","shift","includes","push","isMenuEmpty","menuToCheck","isEmpty","undefined","key","value","state","newState","parentMenu","exports"],"sources":["@wordpress/components/src/navigation/use-create-navigation-tree.tsx"],"sourcesContent":["/**\n * WordPress dependencies\n */\nimport { useState } from '@wordpress/element';\n\n/**\n * Internal dependencies\n */\nimport { useNavigationTreeNodes } from './use-navigation-tree-nodes';\n\nimport type { NavigationContext, Item, Menu } from './types';\n\nexport const useCreateNavigationTree = () => {\n\tconst {\n\t\tnodes: items,\n\t\tgetNode: getItem,\n\t\taddNode: addItem,\n\t\tremoveNode: removeItem,\n\t} = useNavigationTreeNodes< Item >();\n\n\tconst {\n\t\tnodes: menus,\n\t\tgetNode: getMenu,\n\t\taddNode: addMenu,\n\t\tremoveNode: removeMenu,\n\t} = useNavigationTreeNodes< Menu >();\n\n\t/**\n\t * Stores direct nested menus of menus\n\t * This makes it easy to traverse menu tree\n\t *\n\t * Key is the menu prop of the menu\n\t * Value is an array of menu keys\n\t */\n\tconst [ childMenu, setChildMenu ] = useState< Record< string, string[] > >(\n\t\t{}\n\t);\n\tconst getChildMenu = ( menu: string ) => childMenu[ menu ] || [];\n\n\tconst traverseMenu: NavigationContext[ 'navigationTree' ][ 'traverseMenu' ] =\n\t\t( startMenu, callback ) => {\n\t\t\tconst visited: string[] = [];\n\t\t\tlet queue = [ startMenu ];\n\t\t\tlet current: Menu;\n\n\t\t\twhile ( queue.length > 0 ) {\n\t\t\t\t// Type cast to string is safe because of the `length > 0` check above.\n\t\t\t\tcurrent = getMenu( queue.shift() as string );\n\n\t\t\t\tif ( ! current || visited.includes( current.menu ) ) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tvisited.push( current.menu );\n\t\t\t\tqueue = [ ...queue, ...getChildMenu( current.menu ) ];\n\n\t\t\t\tif ( callback( current ) === false ) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\tconst isMenuEmpty = ( menuToCheck: string ) => {\n\t\tlet isEmpty = true;\n\n\t\ttraverseMenu( menuToCheck, ( current: Menu ) => {\n\t\t\tif ( ! current.isEmpty ) {\n\t\t\t\tisEmpty = false;\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\treturn undefined;\n\t\t} );\n\n\t\treturn isEmpty;\n\t};\n\n\treturn {\n\t\titems,\n\t\tgetItem,\n\t\taddItem,\n\t\tremoveItem,\n\n\t\tmenus,\n\t\tgetMenu,\n\t\taddMenu: ( key: string, value: Menu ) => {\n\t\t\tsetChildMenu( ( state ) => {\n\t\t\t\tconst newState = { ...state };\n\n\t\t\t\tif ( ! value.parentMenu ) {\n\t\t\t\t\treturn newState;\n\t\t\t\t}\n\n\t\t\t\tif ( ! newState[ value.parentMenu ] ) {\n\t\t\t\t\tnewState[ value.parentMenu ] = [];\n\t\t\t\t}\n\n\t\t\t\tnewState[ value.parentMenu ].push( key );\n\n\t\t\t\treturn newState;\n\t\t\t} );\n\n\t\t\taddMenu( key, value );\n\t\t},\n\t\tremoveMenu,\n\t\tchildMenu,\n\t\ttraverseMenu,\n\t\tisMenuEmpty,\n\t};\n};\n"],"mappings":";;;;;;AAGA,IAAAA,QAAA,GAAAC,OAAA;AAKA,IAAAC,uBAAA,GAAAD,OAAA;AARA;AACA;AACA;;AAGA;AACA;AACA;;AAKO,MAAME,uBAAuB,GAAGA,CAAA,KAAM;EAC5C,MAAM;IACLC,KAAK,EAAEC,KAAK;IACZC,OAAO,EAAEC,OAAO;IAChBC,OAAO,EAAEC,OAAO;IAChBC,UAAU,EAAEC;EACb,CAAC,GAAG,IAAAC,8CAAsB,EAAS,CAAC;EAEpC,MAAM;IACLR,KAAK,EAAES,KAAK;IACZP,OAAO,EAAEQ,OAAO;IAChBN,OAAO,EAAEO,OAAO;IAChBL,UAAU,EAAEM;EACb,CAAC,GAAG,IAAAJ,8CAAsB,EAAS,CAAC;;EAEpC;AACD;AACA;AACA;AACA;AACA;AACA;EACC,MAAM,CAAEK,SAAS,EAAEC,YAAY,CAAE,GAAG,IAAAC,iBAAQ,EAC3C,CAAC,CACF,CAAC;EACD,MAAMC,YAAY,GAAKC,IAAY,IAAMJ,SAAS,CAAEI,IAAI,CAAE,IAAI,EAAE;EAEhE,MAAMC,YAAqE,GAC1EA,CAAEC,SAAS,EAAEC,QAAQ,KAAM;IAC1B,MAAMC,OAAiB,GAAG,EAAE;IAC5B,IAAIC,KAAK,GAAG,CAAEH,SAAS,CAAE;IACzB,IAAII,OAAa;IAEjB,OAAQD,KAAK,CAACE,MAAM,GAAG,CAAC,EAAG;MAC1B;MACAD,OAAO,GAAGb,OAAO,CAAEY,KAAK,CAACG,KAAK,CAAC,CAAY,CAAC;MAE5C,IAAK,CAAEF,OAAO,IAAIF,OAAO,CAACK,QAAQ,CAAEH,OAAO,CAACN,IAAK,CAAC,EAAG;QACpD;MACD;MAEAI,OAAO,CAACM,IAAI,CAAEJ,OAAO,CAACN,IAAK,CAAC;MAC5BK,KAAK,GAAG,CAAE,GAAGA,KAAK,EAAE,GAAGN,YAAY,CAAEO,OAAO,CAACN,IAAK,CAAC,CAAE;MAErD,IAAKG,QAAQ,CAAEG,OAAQ,CAAC,KAAK,KAAK,EAAG;QACpC;MACD;IACD;EACD,CAAC;EAEF,MAAMK,WAAW,GAAKC,WAAmB,IAAM;IAC9C,IAAIC,OAAO,GAAG,IAAI;IAElBZ,YAAY,CAAEW,WAAW,EAAIN,OAAa,IAAM;MAC/C,IAAK,CAAEA,OAAO,CAACO,OAAO,EAAG;QACxBA,OAAO,GAAG,KAAK;QACf,OAAO,KAAK;MACb;MAEA,OAAOC,SAAS;IACjB,CAAE,CAAC;IAEH,OAAOD,OAAO;EACf,CAAC;EAED,OAAO;IACN7B,KAAK;IACLE,OAAO;IACPE,OAAO;IACPE,UAAU;IAEVE,KAAK;IACLC,OAAO;IACPC,OAAO,EAAEA,CAAEqB,GAAW,EAAEC,KAAW,KAAM;MACxCnB,YAAY,CAAIoB,KAAK,IAAM;QAC1B,MAAMC,QAAQ,GAAG;UAAE,GAAGD;QAAM,CAAC;QAE7B,IAAK,CAAED,KAAK,CAACG,UAAU,EAAG;UACzB,OAAOD,QAAQ;QAChB;QAEA,IAAK,CAAEA,QAAQ,CAAEF,KAAK,CAACG,UAAU,CAAE,EAAG;UACrCD,QAAQ,CAAEF,KAAK,CAACG,UAAU,CAAE,GAAG,EAAE;QAClC;QAEAD,QAAQ,CAAEF,KAAK,CAACG,UAAU,CAAE,CAACT,IAAI,CAAEK,GAAI,CAAC;QAExC,OAAOG,QAAQ;MAChB,CAAE,CAAC;MAEHxB,OAAO,CAAEqB,GAAG,EAAEC,KAAM,CAAC;IACtB,CAAC;IACDrB,UAAU;IACVC,SAAS;IACTK,YAAY;IACZU;EACD,CAAC;AACF,CAAC;AAACS,OAAA,CAAAtC,uBAAA,GAAAA,uBAAA"}