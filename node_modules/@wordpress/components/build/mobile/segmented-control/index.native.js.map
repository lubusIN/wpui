{"version":3,"names":["_element","require","_reactNative","_compose","_layoutAnimation","_style","_interopRequireDefault","ANIMATION_DURATION","isIOS","Platform","OS","Segment","isSelected","title","onPress","onLayout","props","isSelectedIOS","segmentStyle","styles","segment","segmentIOS","textStyle","usePreferredColorSchemeStyle","buttonTextDefault","buttonTextDefaultDark","selectedTextStyle","buttonTextSelected","buttonTextSelectedDark","shadowStyle","shadowIOS","createElement","View","style","TouchableWithoutFeedback","Text","maxFontSizeMultiplier","SegmentedControls","segments","segmentHandler","selectedIndex","addonLeft","addonRight","selectedSegmentIndex","activeSegmentIndex","setActiveSegmentIndex","useState","segmentsDimensions","setSegmentsDimensions","width","height","positionAnimationValue","Animated","Value","useEffect","setValue","calculateEndValue","containerStyle","container","containerDark","performSwatchAnimation","index","timing","toValue","duration","easing","Easing","ease","useNativeDriver","start","paddingLeft","offset","containerIOS","widths","Object","values","map","dimension","widthsDistance","slice","widthsDistanceSum","reduce","sum","n","endValue","onHandlePress","performLayoutAnimation","segmentOnLayout","event","nativeEvent","layout","selectedStyle","selected","selectedDark","outlineStyle","outline","outlineIOS","row","flex","left","key","accessibilityState","accessibilityRole","accessibilityLabel","accessibilityHint","length","_default","exports","default"],"sources":["@wordpress/components/src/mobile/segmented-control/index.native.js"],"sourcesContent":["/**\n * External dependencies\n */\nimport {\n\tView,\n\tTouchableWithoutFeedback,\n\tText,\n\tPlatform,\n\tAnimated,\n\tEasing,\n} from 'react-native';\n/**\n * WordPress dependencies\n */\nimport { useState, useEffect } from '@wordpress/element';\nimport { usePreferredColorSchemeStyle } from '@wordpress/compose';\n\n/**\n * Internal dependencies\n */\nimport { performLayoutAnimation } from '../layout-animation';\nimport styles from './style.scss';\n\nconst ANIMATION_DURATION = 200;\n\nconst isIOS = Platform.OS === 'ios';\n\nconst Segment = ( { isSelected, title, onPress, onLayout, ...props } ) => {\n\tconst isSelectedIOS = isIOS && isSelected;\n\n\tconst segmentStyle = [ styles.segment, isIOS && styles.segmentIOS ];\n\n\tconst textStyle = usePreferredColorSchemeStyle(\n\t\tstyles.buttonTextDefault,\n\t\tstyles.buttonTextDefaultDark\n\t);\n\tconst selectedTextStyle = usePreferredColorSchemeStyle(\n\t\tstyles.buttonTextSelected,\n\t\tstyles.buttonTextSelectedDark\n\t);\n\tconst shadowStyle = usePreferredColorSchemeStyle( styles.shadowIOS, {} );\n\n\treturn (\n\t\t<View style={ isSelectedIOS && shadowStyle }>\n\t\t\t<TouchableWithoutFeedback onPress={ onPress }>\n\t\t\t\t<View style={ segmentStyle } onLayout={ onLayout } { ...props }>\n\t\t\t\t\t<Text\n\t\t\t\t\t\tstyle={ [ textStyle, isSelected && selectedTextStyle ] }\n\t\t\t\t\t\tmaxFontSizeMultiplier={ 2 }\n\t\t\t\t\t>\n\t\t\t\t\t\t{ title }\n\t\t\t\t\t</Text>\n\t\t\t\t</View>\n\t\t\t</TouchableWithoutFeedback>\n\t\t</View>\n\t);\n};\n\nconst SegmentedControls = ( {\n\tsegments,\n\tsegmentHandler,\n\tselectedIndex,\n\taddonLeft,\n\taddonRight,\n} ) => {\n\tconst selectedSegmentIndex = selectedIndex || 0;\n\tconst [ activeSegmentIndex, setActiveSegmentIndex ] =\n\t\tuseState( selectedSegmentIndex );\n\tconst [ segmentsDimensions, setSegmentsDimensions ] = useState( {\n\t\t[ activeSegmentIndex ]: { width: 0, height: 0 },\n\t} );\n\tconst [ positionAnimationValue ] = useState( new Animated.Value( 0 ) );\n\n\tuseEffect( () => {\n\t\tsetActiveSegmentIndex( selectedSegmentIndex );\n\t\tsegmentHandler( segments[ selectedSegmentIndex ] );\n\t\t// Disable reason: deferring this refactor to the native team.\n\t\t// see https://github.com/WordPress/gutenberg/pull/41166\n\t\t// eslint-disable-next-line react-hooks/exhaustive-deps\n\t}, [] );\n\n\tuseEffect( () => {\n\t\tpositionAnimationValue.setValue(\n\t\t\tcalculateEndValue( activeSegmentIndex )\n\t\t);\n\t\t// Disable reason: deferring this refactor to the native team.\n\t\t// see https://github.com/WordPress/gutenberg/pull/41166\n\t\t// eslint-disable-next-line react-hooks/exhaustive-deps\n\t}, [ segmentsDimensions ] );\n\n\tconst containerStyle = usePreferredColorSchemeStyle(\n\t\tstyles.container,\n\t\tstyles.containerDark\n\t);\n\n\tfunction performSwatchAnimation( index ) {\n\t\tAnimated.timing( positionAnimationValue, {\n\t\t\ttoValue: calculateEndValue( index ),\n\t\t\tduration: ANIMATION_DURATION,\n\t\t\teasing: Easing.ease,\n\t\t\tuseNativeDriver: false,\n\t\t} ).start();\n\t}\n\n\tfunction calculateEndValue( index ) {\n\t\tconst { paddingLeft: offset } = isIOS\n\t\t\t? styles.containerIOS\n\t\t\t: styles.container;\n\t\tconst widths = Object.values( segmentsDimensions ).map(\n\t\t\t( dimension ) => dimension.width\n\t\t);\n\t\tconst widthsDistance = widths.slice( 0, index );\n\t\tconst widthsDistanceSum = widthsDistance.reduce(\n\t\t\t( sum, n ) => sum + n,\n\t\t\t0\n\t\t);\n\n\t\tconst endValue = index === 0 ? 0 : widthsDistanceSum;\n\t\treturn endValue + offset;\n\t}\n\n\tfunction onHandlePress( segment, index ) {\n\t\tperformLayoutAnimation( ANIMATION_DURATION );\n\t\tsetActiveSegmentIndex( index );\n\t\tsegmentHandler( segment );\n\t\tperformSwatchAnimation( index );\n\t}\n\n\tfunction segmentOnLayout( event, index ) {\n\t\tconst { width, height } = event.nativeEvent.layout;\n\n\t\tsetSegmentsDimensions( {\n\t\t\t...segmentsDimensions,\n\t\t\t[ index ]: { width, height },\n\t\t} );\n\t}\n\n\tconst selectedStyle = usePreferredColorSchemeStyle(\n\t\tstyles.selected,\n\t\tstyles.selectedDark\n\t);\n\n\tconst width = segmentsDimensions[ activeSegmentIndex ]?.width;\n\tconst height = segmentsDimensions[ activeSegmentIndex ]?.height;\n\n\tconst outlineStyle = [ styles.outline, isIOS && styles.outlineIOS ];\n\n\treturn (\n\t\t<View style={ styles.row }>\n\t\t\t<View style={ styles.flex }>{ addonLeft }</View>\n\t\t\t<View style={ [ containerStyle, isIOS && styles.containerIOS ] }>\n\t\t\t\t<Animated.View\n\t\t\t\t\tstyle={ [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\twidth,\n\t\t\t\t\t\t\tleft: positionAnimationValue,\n\t\t\t\t\t\t\theight,\n\t\t\t\t\t\t},\n\t\t\t\t\t\tselectedStyle,\n\t\t\t\t\t\toutlineStyle,\n\t\t\t\t\t] }\n\t\t\t\t/>\n\t\t\t\t{ segments.map( ( segment, index ) => {\n\t\t\t\t\treturn (\n\t\t\t\t\t\t<Segment\n\t\t\t\t\t\t\ttitle={ segment }\n\t\t\t\t\t\t\tonPress={ () => onHandlePress( segment, index ) }\n\t\t\t\t\t\t\tisSelected={ activeSegmentIndex === index }\n\t\t\t\t\t\t\tkey={ index }\n\t\t\t\t\t\t\tonLayout={ ( event ) =>\n\t\t\t\t\t\t\t\tsegmentOnLayout( event, index )\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\taccessibilityState={ {\n\t\t\t\t\t\t\t\tselected: activeSegmentIndex === index,\n\t\t\t\t\t\t\t} }\n\t\t\t\t\t\t\taccessibilityRole={ 'button' }\n\t\t\t\t\t\t\taccessibilityLabel={ segment }\n\t\t\t\t\t\t\taccessibilityHint={ `${ index + 1 } on ${\n\t\t\t\t\t\t\t\tsegments.length\n\t\t\t\t\t\t\t}` }\n\t\t\t\t\t\t/>\n\t\t\t\t\t);\n\t\t\t\t} ) }\n\t\t\t</View>\n\t\t\t<View style={ styles.flex }>{ addonRight }</View>\n\t\t</View>\n\t);\n};\n\nexport default SegmentedControls;\n"],"mappings":"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"}