{"version":3,"names":["NavigationContainer","DefaultTheme","createStackNavigator","Animated","Easing","useAnimatedStyle","useSharedValue","withTiming","useContext","useMemo","useCallback","Children","useRef","cloneElement","usePreferredColorSchemeStyle","BottomSheetNavigationContext","BottomSheetNavigationProvider","BottomSheetContext","styles","AnimationSpec","animation","config","duration","easing","ease","fadeConfig","current","cardStyle","opacity","progress","options","transitionSpec","open","close","headerShown","gestureEnabled","cardStyleInterpolator","keyboardHandlingEnabled","HEIGHT_ANIMATION_DURATION","DEFAULT_HEIGHT","BottomSheetNavigationContainer","children","animate","main","theme","style","testID","Stack","navigationContext","maxHeight","sheetMaxHeight","isMaxHeightSet","isSheetMaxHeightSet","currentHeight","value","backgroundStyle","background","backgroundDark","defaultTheme","colors","backgroundColor","_theme","setHeight","height","Math","round","newHeight","min","shouldAnimate","out","cubic","animatedStyles","screens","map","child","screen","name","otherProps","props","isNested","createElement","Screen","View","Navigator","screenOptions","detachInactiveScreens"],"sources":["@wordpress/components/src/mobile/bottom-sheet/bottom-sheet-navigation/navigation-container.native.js"],"sourcesContent":["/**\n * External dependencies\n */\nimport { NavigationContainer, DefaultTheme } from '@react-navigation/native';\nimport { createStackNavigator } from '@react-navigation/stack';\nimport Animated, {\n\tEasing,\n\tuseAnimatedStyle,\n\tuseSharedValue,\n\twithTiming,\n} from 'react-native-reanimated';\n\n/**\n * WordPress dependencies\n */\nimport {\n\tuseContext,\n\tuseMemo,\n\tuseCallback,\n\tChildren,\n\tuseRef,\n\tcloneElement,\n} from '@wordpress/element';\n\nimport { usePreferredColorSchemeStyle } from '@wordpress/compose';\n\n/**\n * Internal dependencies\n */\nimport {\n\tBottomSheetNavigationContext,\n\tBottomSheetNavigationProvider,\n} from './bottom-sheet-navigation-context';\nimport { BottomSheetContext } from '../bottom-sheet-context';\n\nimport styles from './styles.scss';\n\nconst AnimationSpec = {\n\tanimation: 'timing',\n\tconfig: {\n\t\tduration: 200,\n\t\teasing: Easing.ease,\n\t},\n};\n\nconst fadeConfig = ( { current } ) => {\n\treturn {\n\t\tcardStyle: {\n\t\t\topacity: current.progress,\n\t\t},\n\t};\n};\n\nconst options = {\n\ttransitionSpec: {\n\t\topen: AnimationSpec,\n\t\tclose: AnimationSpec,\n\t},\n\theaderShown: false,\n\tgestureEnabled: false,\n\tcardStyleInterpolator: fadeConfig,\n\tkeyboardHandlingEnabled: false,\n};\n\nconst HEIGHT_ANIMATION_DURATION = 300;\nconst DEFAULT_HEIGHT = 1;\n\nfunction BottomSheetNavigationContainer( {\n\tchildren,\n\tanimate,\n\tmain,\n\ttheme,\n\tstyle,\n\ttestID,\n} ) {\n\tconst Stack = useRef( createStackNavigator() ).current;\n\tconst navigationContext = useContext( BottomSheetNavigationContext );\n\tconst { maxHeight: sheetMaxHeight, isMaxHeightSet: isSheetMaxHeightSet } =\n\t\tuseContext( BottomSheetContext );\n\tconst currentHeight = useSharedValue(\n\t\tnavigationContext.currentHeight?.value || DEFAULT_HEIGHT\n\t);\n\n\tconst backgroundStyle = usePreferredColorSchemeStyle(\n\t\tstyles.background,\n\t\tstyles.backgroundDark\n\t);\n\n\tconst defaultTheme = useMemo(\n\t\t() => ( {\n\t\t\t...DefaultTheme,\n\t\t\tcolors: {\n\t\t\t\t...DefaultTheme.colors,\n\t\t\t\tbackground: backgroundStyle.backgroundColor,\n\t\t\t},\n\t\t} ),\n\t\t[ backgroundStyle.backgroundColor ]\n\t);\n\tconst _theme = theme || defaultTheme;\n\n\tconst setHeight = useCallback(\n\t\t( height ) => {\n\t\t\tif (\n\t\t\t\theight > DEFAULT_HEIGHT &&\n\t\t\t\tMath.round( height ) !== Math.round( currentHeight.value )\n\t\t\t) {\n\t\t\t\t// If max height is set in the bottom sheet, we clamp\n\t\t\t\t// the new height using that value.\n\t\t\t\tconst newHeight = isSheetMaxHeightSet\n\t\t\t\t\t? Math.min( sheetMaxHeight, height )\n\t\t\t\t\t: height;\n\t\t\t\tconst shouldAnimate =\n\t\t\t\t\tanimate && currentHeight.value !== DEFAULT_HEIGHT;\n\n\t\t\t\tif ( shouldAnimate ) {\n\t\t\t\t\tcurrentHeight.value = withTiming( newHeight, {\n\t\t\t\t\t\tduration: HEIGHT_ANIMATION_DURATION,\n\t\t\t\t\t\teasing: Easing.out( Easing.cubic ),\n\t\t\t\t\t} );\n\t\t\t\t} else {\n\t\t\t\t\tcurrentHeight.value = newHeight;\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\t[ animate, currentHeight, isSheetMaxHeightSet, sheetMaxHeight ]\n\t);\n\n\tconst animatedStyles = useAnimatedStyle( () => ( {\n\t\theight: currentHeight.value,\n\t} ) );\n\n\tconst screens = useMemo( () => {\n\t\treturn Children.map( children, ( child ) => {\n\t\t\tlet screen = child;\n\t\t\tconst { name, ...otherProps } = child.props;\n\t\t\tif ( ! main ) {\n\t\t\t\tscreen = cloneElement( child, {\n\t\t\t\t\t...child.props,\n\t\t\t\t\tisNested: true,\n\t\t\t\t} );\n\t\t\t}\n\t\t\treturn (\n\t\t\t\t<Stack.Screen\n\t\t\t\t\tname={ name }\n\t\t\t\t\t{ ...otherProps }\n\t\t\t\t\tchildren={ () => screen }\n\t\t\t\t/>\n\t\t\t);\n\t\t} );\n\t}, [ children, main ] );\n\n\treturn useMemo( () => {\n\t\treturn (\n\t\t\t<Animated.View\n\t\t\t\tstyle={ [ style, animatedStyles ] }\n\t\t\t\ttestID={ testID }\n\t\t\t>\n\t\t\t\t<BottomSheetNavigationProvider\n\t\t\t\t\tvalue={ { setHeight, currentHeight } }\n\t\t\t\t>\n\t\t\t\t\t{ main ? (\n\t\t\t\t\t\t<NavigationContainer theme={ _theme }>\n\t\t\t\t\t\t\t<Stack.Navigator\n\t\t\t\t\t\t\t\tscreenOptions={ options }\n\t\t\t\t\t\t\t\tdetachInactiveScreens={ false }\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{ screens }\n\t\t\t\t\t\t\t</Stack.Navigator>\n\t\t\t\t\t\t</NavigationContainer>\n\t\t\t\t\t) : (\n\t\t\t\t\t\t<Stack.Navigator\n\t\t\t\t\t\t\tscreenOptions={ options }\n\t\t\t\t\t\t\tdetachInactiveScreens={ false }\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{ screens }\n\t\t\t\t\t\t</Stack.Navigator>\n\t\t\t\t\t) }\n\t\t\t\t</BottomSheetNavigationProvider>\n\t\t\t</Animated.View>\n\t\t);\n\t}, [\n\t\t_theme,\n\t\tanimatedStyles,\n\t\tcurrentHeight,\n\t\tmain,\n\t\tscreens,\n\t\tsetHeight,\n\t\tstyle,\n\t\ttestID,\n\t] );\n}\n\nexport default BottomSheetNavigationContainer;\n"],"mappings":"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"}