{"version":3,"names":["_element","require","_values","defaultOptions","initial","undefined","fallback","useControlledState","currentState","options","internalState","setInternalState","useState","hasCurrentState","isValueDefined","useEffect","state","getDefinedValue","setState","useCallback","nextState","_default","exports","default"],"sources":["@wordpress/components/src/utils/hooks/use-controlled-state.js"],"sourcesContent":["/**\n * WordPress dependencies\n */\nimport { useEffect, useState, useCallback } from '@wordpress/element';\n\n/**\n * Internal dependencies\n */\nimport { isValueDefined, getDefinedValue } from '../values';\n\n/**\n * @template T\n * @typedef Options\n * @property {T}      [initial] Initial value\n * @property {T | \"\"} fallback  Fallback value\n */\n\n/** @type {Readonly<{ initial: undefined, fallback: '' }>} */\nconst defaultOptions = {\n\tinitial: undefined,\n\t/**\n\t * Defaults to empty string, as that is preferred for usage with\n\t * <input />, <textarea />, and <select /> form elements.\n\t */\n\tfallback: '',\n};\n\n/**\n * Custom hooks for \"controlled\" components to track and consolidate internal\n * state and incoming values. This is useful for components that render\n * `input`, `textarea`, or `select` HTML elements.\n *\n * https://reactjs.org/docs/forms.html#controlled-components\n *\n * At first, a component using useControlledState receives an initial prop\n * value, which is used as initial internal state.\n *\n * This internal state can be maintained and updated without\n * relying on new incoming prop values.\n *\n * Unlike the basic useState hook, useControlledState's state can\n * be updated if a new incoming prop value is changed.\n *\n * @template T\n *\n * @param {T | undefined} currentState             The current value.\n * @param {Options<T>}    [options=defaultOptions] Additional options for the hook.\n *\n * @return {[T | \"\", (nextState: T) => void]} The controlled value and the value setter.\n */\nfunction useControlledState( currentState, options = defaultOptions ) {\n\tconst { initial, fallback } = { ...defaultOptions, ...options };\n\n\tconst [ internalState, setInternalState ] = useState( currentState );\n\tconst hasCurrentState = isValueDefined( currentState );\n\n\t/*\n\t * Resets internal state if value every changes from uncontrolled <-> controlled.\n\t */\n\tuseEffect( () => {\n\t\tif ( hasCurrentState && internalState ) {\n\t\t\tsetInternalState( undefined );\n\t\t}\n\t}, [ hasCurrentState, internalState ] );\n\n\tconst state = getDefinedValue(\n\t\t[ currentState, internalState, initial ],\n\t\tfallback\n\t);\n\n\t/* eslint-disable jsdoc/no-undefined-types */\n\t/** @type {(nextState: T) => void} */\n\tconst setState = useCallback(\n\t\t( nextState ) => {\n\t\t\tif ( ! hasCurrentState ) {\n\t\t\t\tsetInternalState( nextState );\n\t\t\t}\n\t\t},\n\t\t[ hasCurrentState ]\n\t);\n\t/* eslint-enable jsdoc/no-undefined-types */\n\n\treturn [ state, setState ];\n}\n\nexport default useControlledState;\n"],"mappings":";;;;;;AAGA,IAAAA,QAAA,GAAAC,OAAA;AAKA,IAAAC,OAAA,GAAAD,OAAA;AARA;AACA;AACA;;AAGA;AACA;AACA;;AAGA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,MAAME,cAAc,GAAG;EACtBC,OAAO,EAAEC,SAAS;EAClB;AACD;AACA;AACA;EACCC,QAAQ,EAAE;AACX,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAASC,kBAAkBA,CAAEC,YAAY,EAAEC,OAAO,GAAGN,cAAc,EAAG;EACrE,MAAM;IAAEC,OAAO;IAAEE;EAAS,CAAC,GAAG;IAAE,GAAGH,cAAc;IAAE,GAAGM;EAAQ,CAAC;EAE/D,MAAM,CAAEC,aAAa,EAAEC,gBAAgB,CAAE,GAAG,IAAAC,iBAAQ,EAAEJ,YAAa,CAAC;EACpE,MAAMK,eAAe,GAAG,IAAAC,sBAAc,EAAEN,YAAa,CAAC;;EAEtD;AACD;AACA;EACC,IAAAO,kBAAS,EAAE,MAAM;IAChB,IAAKF,eAAe,IAAIH,aAAa,EAAG;MACvCC,gBAAgB,CAAEN,SAAU,CAAC;IAC9B;EACD,CAAC,EAAE,CAAEQ,eAAe,EAAEH,aAAa,CAAG,CAAC;EAEvC,MAAMM,KAAK,GAAG,IAAAC,uBAAe,EAC5B,CAAET,YAAY,EAAEE,aAAa,EAAEN,OAAO,CAAE,EACxCE,QACD,CAAC;;EAED;EACA;EACA,MAAMY,QAAQ,GAAG,IAAAC,oBAAW,EACzBC,SAAS,IAAM;IAChB,IAAK,CAAEP,eAAe,EAAG;MACxBF,gBAAgB,CAAES,SAAU,CAAC;IAC9B;EACD,CAAC,EACD,CAAEP,eAAe,CAClB,CAAC;EACD;;EAEA,OAAO,CAAEG,KAAK,EAAEE,QAAQ,CAAE;AAC3B;AAAC,IAAAG,QAAA,GAEcd,kBAAkB;AAAAe,OAAA,CAAAC,OAAA,GAAAF,QAAA"}