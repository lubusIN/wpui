{"version":3,"names":["_element","require","_reactNative","_rangeCell","_interopRequireDefault","_stepperCell","_picker","_style","_utils","_compose","_i18n","UnitControl","currentInput","label","value","onChange","onUnitChange","initialPosition","min","max","separatorType","units","CSS_UNITS","unit","getStylesFromColorScheme","props","pickerRef","useRef","anchorNodeRef","onPickerPresent","useCallback","current","presentPicker","currentInputValue","initialControlValue","isFinite","unitButtonTextStyle","styles","unitButtonText","unitButtonTextDark","accessibilityLabel","sprintf","__","accessibilityHint","Platform","OS","renderUnitButton","useMemo","unitButton","createElement","View","style","Text","hasUnits","length","TouchableWithoutFeedback","onPress","accessibilityRole","getAnchor","findNodeHandle","undefined","getDecimal","step","stepToString","splitStep","toString","split","renderUnitPicker","unitMenu","ref","default","options","hideCancelButton","leftAlign","_activeUnit$step","activeUnit","find","option","decimalNum","Fragment","defaultValue","shouldDisplayTextInput","openUnitPicker","unitLabel","getAccessibleLabelForUnit","minimumValue","maximumValue","_default","memo","withPreferredColorScheme","exports"],"sources":["@wordpress/components/src/unit-control/index.native.js"],"sourcesContent":["/**\n * External dependencies\n */\nimport {\n\tText,\n\tView,\n\tTouchableWithoutFeedback,\n\tPlatform,\n\tfindNodeHandle,\n} from 'react-native';\n\n/**\n * Internal dependencies\n */\nimport RangeCell from '../mobile/bottom-sheet/range-cell';\nimport StepperCell from '../mobile/bottom-sheet/stepper-cell';\nimport Picker from '../mobile/picker';\nimport styles from './style.scss';\nimport { CSS_UNITS, hasUnits, getAccessibleLabelForUnit } from './utils';\n\n/**\n * WordPress dependencies\n */\nimport { useRef, useCallback, useMemo, memo } from '@wordpress/element';\nimport { withPreferredColorScheme } from '@wordpress/compose';\nimport { __, sprintf } from '@wordpress/i18n';\n\nfunction UnitControl( {\n\tcurrentInput,\n\tlabel,\n\tvalue,\n\tonChange,\n\tonUnitChange,\n\tinitialPosition,\n\tmin,\n\tmax,\n\tseparatorType,\n\tunits = CSS_UNITS,\n\tunit,\n\tgetStylesFromColorScheme,\n\t...props\n} ) {\n\tconst pickerRef = useRef();\n\tconst anchorNodeRef = useRef();\n\n\tconst onPickerPresent = useCallback( () => {\n\t\tif ( pickerRef?.current ) {\n\t\t\tpickerRef.current.presentPicker();\n\t\t}\n\t\t// Disable reason: this should be fixed by the native team.\n\t\t// It would be great if this could be done in the context of\n\t\t// https://github.com/WordPress/gutenberg/pull/39218\n\t\t// eslint-disable-next-line react-hooks/exhaustive-deps\n\t}, [ pickerRef?.current ] );\n\n\tconst currentInputValue = currentInput === null ? value : currentInput;\n\tconst initialControlValue = isFinite( currentInputValue )\n\t\t? currentInputValue\n\t\t: initialPosition;\n\n\tconst unitButtonTextStyle = getStylesFromColorScheme(\n\t\tstyles.unitButtonText,\n\t\tstyles.unitButtonTextDark\n\t);\n\n\t/* translators: accessibility text. Inform about current unit value. %s: Current unit value. */\n\tconst accessibilityLabel = sprintf( __( 'Current unit is %s' ), unit );\n\n\tconst accessibilityHint =\n\t\tPlatform.OS === 'ios'\n\t\t\t? __( 'Double tap to open Action Sheet with available options' )\n\t\t\t: __( 'Double tap to open Bottom Sheet with available options' );\n\n\tconst renderUnitButton = useMemo( () => {\n\t\tconst unitButton = (\n\t\t\t<View style={ styles.unitButton }>\n\t\t\t\t<Text style={ unitButtonTextStyle }>{ unit }</Text>\n\t\t\t</View>\n\t\t);\n\n\t\tif ( hasUnits( units ) && units?.length > 1 ) {\n\t\t\treturn (\n\t\t\t\t<TouchableWithoutFeedback\n\t\t\t\t\tonPress={ onPickerPresent }\n\t\t\t\t\taccessibilityLabel={ accessibilityLabel }\n\t\t\t\t\taccessibilityRole=\"button\"\n\t\t\t\t\taccessibilityHint={ accessibilityHint }\n\t\t\t\t>\n\t\t\t\t\t{ unitButton }\n\t\t\t\t</TouchableWithoutFeedback>\n\t\t\t);\n\t\t}\n\n\t\treturn unitButton;\n\t}, [\n\t\tonPickerPresent,\n\t\taccessibilityLabel,\n\t\taccessibilityHint,\n\t\tunitButtonTextStyle,\n\t\tunit,\n\t\tunits,\n\t] );\n\n\tconst getAnchor = useCallback(\n\t\t() =>\n\t\t\tanchorNodeRef?.current\n\t\t\t\t? findNodeHandle( anchorNodeRef?.current )\n\t\t\t\t: undefined,\n\t\t// Disable reason: this should be fixed by the native team.\n\t\t// It would be great if this could be done in the context of\n\t\t// https://github.com/WordPress/gutenberg/pull/39218\n\t\t// eslint-disable-next-line react-hooks/exhaustive-deps\n\t\t[ anchorNodeRef?.current ]\n\t);\n\n\tconst getDecimal = ( step ) => {\n\t\t// Return the decimal offset based on the step size.\n\t\t// if step size is 0.1 we expect the offset to be 1.\n\t\t// for example 12 + 0.1 we would expect the see 12.1 (not 12.10 or 12 );\n\t\t// steps are defined in the CSS_UNITS and they vary from unit to unit.\n\t\tconst stepToString = step;\n\t\tconst splitStep = stepToString.toString().split( '.' );\n\t\treturn splitStep[ 1 ] ? splitStep[ 1 ].length : 0;\n\t};\n\n\tconst renderUnitPicker = useCallback( () => {\n\t\t// Keeping for legacy reasons, although `false` should not be a valid\n\t\t// value for the `units` prop anymore.\n\t\tif ( units === false ) {\n\t\t\treturn null;\n\t\t}\n\t\treturn (\n\t\t\t<View style={ styles.unitMenu } ref={ anchorNodeRef }>\n\t\t\t\t{ renderUnitButton }\n\t\t\t\t{ hasUnits( units ) && units?.length > 1 ? (\n\t\t\t\t\t<Picker\n\t\t\t\t\t\tref={ pickerRef }\n\t\t\t\t\t\toptions={ units }\n\t\t\t\t\t\tonChange={ onUnitChange }\n\t\t\t\t\t\thideCancelButton\n\t\t\t\t\t\tleftAlign\n\t\t\t\t\t\tgetAnchor={ getAnchor }\n\t\t\t\t\t/>\n\t\t\t\t) : null }\n\t\t\t</View>\n\t\t);\n\t}, [ pickerRef, units, onUnitChange, getAnchor, renderUnitButton ] );\n\n\tlet step = props.step;\n\n\t/*\n\t * If no step prop has been passed, lookup the active unit and\n\t * try to get step from `units`, or default to a value of `1`\n\t */\n\tif ( ! step && units ) {\n\t\tconst activeUnit = units.find( ( option ) => option.value === unit );\n\t\tstep = activeUnit?.step ?? 1;\n\t}\n\n\tconst decimalNum = getDecimal( step );\n\n\treturn (\n\t\t<>\n\t\t\t{ unit !== '%' ? (\n\t\t\t\t<StepperCell\n\t\t\t\t\tlabel={ label }\n\t\t\t\t\tmax={ max }\n\t\t\t\t\tmin={ min }\n\t\t\t\t\tonChange={ onChange }\n\t\t\t\t\tseparatorType={ separatorType }\n\t\t\t\t\tvalue={ value }\n\t\t\t\t\tstep={ step }\n\t\t\t\t\tdefaultValue={ initialControlValue }\n\t\t\t\t\tshouldDisplayTextInput\n\t\t\t\t\tdecimalNum={ decimalNum }\n\t\t\t\t\topenUnitPicker={ onPickerPresent }\n\t\t\t\t\tunitLabel={ getAccessibleLabelForUnit( unit ) }\n\t\t\t\t\t{ ...props }\n\t\t\t\t>\n\t\t\t\t\t{ renderUnitPicker() }\n\t\t\t\t</StepperCell>\n\t\t\t) : (\n\t\t\t\t<RangeCell\n\t\t\t\t\tlabel={ label }\n\t\t\t\t\tonChange={ onChange }\n\t\t\t\t\tminimumValue={ min }\n\t\t\t\t\tmaximumValue={ max }\n\t\t\t\t\tvalue={ value }\n\t\t\t\t\tstep={ step }\n\t\t\t\t\tunit={ unit }\n\t\t\t\t\tdefaultValue={ initialControlValue }\n\t\t\t\t\tseparatorType={ separatorType }\n\t\t\t\t\tdecimalNum={ decimalNum }\n\t\t\t\t\topenUnitPicker={ onPickerPresent }\n\t\t\t\t\tunitLabel={ getAccessibleLabelForUnit( unit ) }\n\t\t\t\t\t{ ...props }\n\t\t\t\t>\n\t\t\t\t\t{ renderUnitPicker() }\n\t\t\t\t</RangeCell>\n\t\t\t) }\n\t\t</>\n\t);\n}\n\nexport { useCustomUnits } from './utils';\nexport default memo( withPreferredColorScheme( UnitControl ) );\n"],"mappings":";;;;;;;;;;;;;AAuBA,IAAAA,QAAA,GAAAC,OAAA;AApBA,IAAAC,YAAA,GAAAD,OAAA;AAWA,IAAAE,UAAA,GAAAC,sBAAA,CAAAH,OAAA;AACA,IAAAI,YAAA,GAAAD,sBAAA,CAAAH,OAAA;AACA,IAAAK,OAAA,GAAAF,sBAAA,CAAAH,OAAA;AACA,IAAAM,MAAA,GAAAH,sBAAA,CAAAH,OAAA;AACA,IAAAO,MAAA,GAAAP,OAAA;AAMA,IAAAQ,QAAA,GAAAR,OAAA;AACA,IAAAS,KAAA,GAAAT,OAAA;AAzBA;AACA;AACA;;AASA;AACA;AACA;;AAOA;AACA;AACA;;AAKA,SAASU,WAAWA,CAAE;EACrBC,YAAY;EACZC,KAAK;EACLC,KAAK;EACLC,QAAQ;EACRC,YAAY;EACZC,eAAe;EACfC,GAAG;EACHC,GAAG;EACHC,aAAa;EACbC,KAAK,GAAGC,gBAAS;EACjBC,IAAI;EACJC,wBAAwB;EACxB,GAAGC;AACJ,CAAC,EAAG;EACH,MAAMC,SAAS,GAAG,IAAAC,eAAM,EAAC,CAAC;EAC1B,MAAMC,aAAa,GAAG,IAAAD,eAAM,EAAC,CAAC;EAE9B,MAAME,eAAe,GAAG,IAAAC,oBAAW,EAAE,MAAM;IAC1C,IAAKJ,SAAS,EAAEK,OAAO,EAAG;MACzBL,SAAS,CAACK,OAAO,CAACC,aAAa,CAAC,CAAC;IAClC;IACA;IACA;IACA;IACA;EACD,CAAC,EAAE,CAAEN,SAAS,EAAEK,OAAO,CAAG,CAAC;EAE3B,MAAME,iBAAiB,GAAGrB,YAAY,KAAK,IAAI,GAAGE,KAAK,GAAGF,YAAY;EACtE,MAAMsB,mBAAmB,GAAGC,QAAQ,CAAEF,iBAAkB,CAAC,GACtDA,iBAAiB,GACjBhB,eAAe;EAElB,MAAMmB,mBAAmB,GAAGZ,wBAAwB,CACnDa,cAAM,CAACC,cAAc,EACrBD,cAAM,CAACE,kBACR,CAAC;;EAED;EACA,MAAMC,kBAAkB,GAAG,IAAAC,aAAO,EAAE,IAAAC,QAAE,EAAE,oBAAqB,CAAC,EAAEnB,IAAK,CAAC;EAEtE,MAAMoB,iBAAiB,GACtBC,qBAAQ,CAACC,EAAE,KAAK,KAAK,GAClB,IAAAH,QAAE,EAAE,wDAAyD,CAAC,GAC9D,IAAAA,QAAE,EAAE,wDAAyD,CAAC;EAElE,MAAMI,gBAAgB,GAAG,IAAAC,gBAAO,EAAE,MAAM;IACvC,MAAMC,UAAU,GACf,IAAAhD,QAAA,CAAAiD,aAAA,EAAC/C,YAAA,CAAAgD,IAAI;MAACC,KAAK,EAAGd,cAAM,CAACW;IAAY,GAChC,IAAAhD,QAAA,CAAAiD,aAAA,EAAC/C,YAAA,CAAAkD,IAAI;MAACD,KAAK,EAAGf;IAAqB,GAAGb,IAAY,CAC7C,CACN;IAED,IAAK,IAAA8B,eAAQ,EAAEhC,KAAM,CAAC,IAAIA,KAAK,EAAEiC,MAAM,GAAG,CAAC,EAAG;MAC7C,OACC,IAAAtD,QAAA,CAAAiD,aAAA,EAAC/C,YAAA,CAAAqD,wBAAwB;QACxBC,OAAO,EAAG3B,eAAiB;QAC3BW,kBAAkB,EAAGA,kBAAoB;QACzCiB,iBAAiB,EAAC,QAAQ;QAC1Bd,iBAAiB,EAAGA;MAAmB,GAErCK,UACuB,CAAC;IAE7B;IAEA,OAAOA,UAAU;EAClB,CAAC,EAAE,CACFnB,eAAe,EACfW,kBAAkB,EAClBG,iBAAiB,EACjBP,mBAAmB,EACnBb,IAAI,EACJF,KAAK,CACJ,CAAC;EAEH,MAAMqC,SAAS,GAAG,IAAA5B,oBAAW,EAC5B,MACCF,aAAa,EAAEG,OAAO,GACnB,IAAA4B,2BAAc,EAAE/B,aAAa,EAAEG,OAAQ,CAAC,GACxC6B,SAAS;EACb;EACA;EACA;EACA;EACA,CAAEhC,aAAa,EAAEG,OAAO,CACzB,CAAC;EAED,MAAM8B,UAAU,GAAKC,IAAI,IAAM;IAC9B;IACA;IACA;IACA;IACA,MAAMC,YAAY,GAAGD,IAAI;IACzB,MAAME,SAAS,GAAGD,YAAY,CAACE,QAAQ,CAAC,CAAC,CAACC,KAAK,CAAE,GAAI,CAAC;IACtD,OAAOF,SAAS,CAAE,CAAC,CAAE,GAAGA,SAAS,CAAE,CAAC,CAAE,CAACV,MAAM,GAAG,CAAC;EAClD,CAAC;EAED,MAAMa,gBAAgB,GAAG,IAAArC,oBAAW,EAAE,MAAM;IAC3C;IACA;IACA,IAAKT,KAAK,KAAK,KAAK,EAAG;MACtB,OAAO,IAAI;IACZ;IACA,OACC,IAAArB,QAAA,CAAAiD,aAAA,EAAC/C,YAAA,CAAAgD,IAAI;MAACC,KAAK,EAAGd,cAAM,CAAC+B,QAAU;MAACC,GAAG,EAAGzC;IAAe,GAClDkB,gBAAgB,EAChB,IAAAO,eAAQ,EAAEhC,KAAM,CAAC,IAAIA,KAAK,EAAEiC,MAAM,GAAG,CAAC,GACvC,IAAAtD,QAAA,CAAAiD,aAAA,EAAC3C,OAAA,CAAAgE,OAAM;MACND,GAAG,EAAG3C,SAAW;MACjB6C,OAAO,EAAGlD,KAAO;MACjBN,QAAQ,EAAGC,YAAc;MACzBwD,gBAAgB;MAChBC,SAAS;MACTf,SAAS,EAAGA;IAAW,CACvB,CAAC,GACC,IACC,CAAC;EAET,CAAC,EAAE,CAAEhC,SAAS,EAAEL,KAAK,EAAEL,YAAY,EAAE0C,SAAS,EAAEZ,gBAAgB,CAAG,CAAC;EAEpE,IAAIgB,IAAI,GAAGrC,KAAK,CAACqC,IAAI;;EAErB;AACD;AACA;AACA;EACC,IAAK,CAAEA,IAAI,IAAIzC,KAAK,EAAG;IAAA,IAAAqD,gBAAA;IACtB,MAAMC,UAAU,GAAGtD,KAAK,CAACuD,IAAI,CAAIC,MAAM,IAAMA,MAAM,CAAC/D,KAAK,KAAKS,IAAK,CAAC;IACpEuC,IAAI,IAAAY,gBAAA,GAAGC,UAAU,EAAEb,IAAI,cAAAY,gBAAA,cAAAA,gBAAA,GAAI,CAAC;EAC7B;EAEA,MAAMI,UAAU,GAAGjB,UAAU,CAAEC,IAAK,CAAC;EAErC,OACC,IAAA9D,QAAA,CAAAiD,aAAA,EAAAjD,QAAA,CAAA+E,QAAA,QACGxD,IAAI,KAAK,GAAG,GACb,IAAAvB,QAAA,CAAAiD,aAAA,EAAC5C,YAAA,CAAAiE,OAAW;IACXzD,KAAK,EAAGA,KAAO;IACfM,GAAG,EAAGA,GAAK;IACXD,GAAG,EAAGA,GAAK;IACXH,QAAQ,EAAGA,QAAU;IACrBK,aAAa,EAAGA,aAAe;IAC/BN,KAAK,EAAGA,KAAO;IACfgD,IAAI,EAAGA,IAAM;IACbkB,YAAY,EAAG9C,mBAAqB;IACpC+C,sBAAsB;IACtBH,UAAU,EAAGA,UAAY;IACzBI,cAAc,EAAGrD,eAAiB;IAClCsD,SAAS,EAAG,IAAAC,gCAAyB,EAAE7D,IAAK,CAAG;IAAA,GAC1CE;EAAK,GAER0C,gBAAgB,CAAC,CACP,CAAC,GAEd,IAAAnE,QAAA,CAAAiD,aAAA,EAAC9C,UAAA,CAAAmE,OAAS;IACTzD,KAAK,EAAGA,KAAO;IACfE,QAAQ,EAAGA,QAAU;IACrBsE,YAAY,EAAGnE,GAAK;IACpBoE,YAAY,EAAGnE,GAAK;IACpBL,KAAK,EAAGA,KAAO;IACfgD,IAAI,EAAGA,IAAM;IACbvC,IAAI,EAAGA,IAAM;IACbyD,YAAY,EAAG9C,mBAAqB;IACpCd,aAAa,EAAGA,aAAe;IAC/B0D,UAAU,EAAGA,UAAY;IACzBI,cAAc,EAAGrD,eAAiB;IAClCsD,SAAS,EAAG,IAAAC,gCAAyB,EAAE7D,IAAK,CAAG;IAAA,GAC1CE;EAAK,GAER0C,gBAAgB,CAAC,CACT,CAEX,CAAC;AAEL;AAAC,IAAAoB,QAAA,GAGc,IAAAC,aAAI,EAAE,IAAAC,iCAAwB,EAAE9E,WAAY,CAAE,CAAC;AAAA+E,OAAA,CAAApB,OAAA,GAAAiB,QAAA"}