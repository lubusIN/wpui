{"version":3,"names":["ScrollView","TextInput","Component","__","parse","withDispatch","withSelect","addFilter","removeFilter","withInstanceId","compose","withPreferredColorScheme","KeyboardAvoidingView","styles","HTMLTextInput","constructor","arguments","edit","bind","stopEditing","getHTMLForParent","state","getDerivedStateFromProps","props","isDirty","value","componentWillUnmount","html","onChange","setState","onPersist","render","editTitle","getStylesFromColorScheme","parentHeight","style","title","titleStyle","htmlViewTitle","text","color","htmlStyle","htmlView","htmlViewDark","placeholderStyle","placeholder","placeholderDark","createElement","keyboardAvoidingView","scrollView","autoCorrect","accessibilityLabel","textAlignVertical","numberOfLines","placeholderTextColor","onChangeText","ref","contentTextInputRef","multiline","onBlur","scrollEnabled","rejectResponderTermination","select","getEditedPostAttribute","getEditedPostContent","dispatch","editPost","resetEditorBlocks","content","blocks"],"sources":["@wordpress/components/src/mobile/html-text-input/index.native.js"],"sourcesContent":["/**\n * External dependencies\n */\nimport { ScrollView, TextInput } from 'react-native';\n\n/**\n * WordPress dependencies\n */\nimport { Component } from '@wordpress/element';\nimport { __ } from '@wordpress/i18n';\nimport { parse } from '@wordpress/blocks';\nimport { withDispatch, withSelect } from '@wordpress/data';\nimport { addFilter, removeFilter } from '@wordpress/hooks';\nimport {\n\twithInstanceId,\n\tcompose,\n\twithPreferredColorScheme,\n} from '@wordpress/compose';\n\n/**\n * Internal dependencies\n */\nimport KeyboardAvoidingView from '../keyboard-avoiding-view';\nimport styles from './style.scss';\n\nexport class HTMLTextInput extends Component {\n\tconstructor() {\n\t\tsuper( ...arguments );\n\n\t\tthis.edit = this.edit.bind( this );\n\t\tthis.stopEditing = this.stopEditing.bind( this );\n\t\tthis.getHTMLForParent = this.getHTMLForParent.bind( this );\n\t\taddFilter(\n\t\t\t'native.persist-html',\n\t\t\t'html-text-input',\n\t\t\tthis.getHTMLForParent\n\t\t);\n\n\t\tthis.state = {};\n\t}\n\n\tstatic getDerivedStateFromProps( props, state ) {\n\t\tif ( state.isDirty ) {\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\tvalue: props.value,\n\t\t\tisDirty: false,\n\t\t};\n\t}\n\n\tcomponentWillUnmount() {\n\t\tremoveFilter( 'native.persist-html', 'html-text-input' );\n\t\t// TODO: Blocking main thread.\n\t\tthis.stopEditing();\n\t}\n\n\tedit( html ) {\n\t\tthis.props.onChange( html );\n\t\tthis.setState( { value: html, isDirty: true } );\n\t}\n\n\tgetHTMLForParent() {\n\t\treturn this.state.value;\n\t}\n\n\tstopEditing() {\n\t\tif ( this.state.isDirty ) {\n\t\t\tthis.props.onPersist( this.state.value );\n\t\t\tthis.setState( { isDirty: false } );\n\t\t}\n\t}\n\n\trender() {\n\t\tconst {\n\t\t\teditTitle,\n\t\t\tgetStylesFromColorScheme,\n\t\t\tparentHeight,\n\t\t\tstyle,\n\t\t\ttitle,\n\t\t} = this.props;\n\t\tconst titleStyle = [\n\t\t\tstyles.htmlViewTitle,\n\t\t\tstyle?.text && { color: style.text },\n\t\t];\n\t\tconst htmlStyle = [\n\t\t\tgetStylesFromColorScheme( styles.htmlView, styles.htmlViewDark ),\n\t\t\tstyle?.text && { color: style.text },\n\t\t];\n\t\tconst placeholderStyle = {\n\t\t\t...getStylesFromColorScheme(\n\t\t\t\tstyles.placeholder,\n\t\t\t\tstyles.placeholderDark\n\t\t\t),\n\t\t\t...( style?.text && { color: style.text } ),\n\t\t};\n\t\treturn (\n\t\t\t<KeyboardAvoidingView\n\t\t\t\tstyle={ styles.keyboardAvoidingView }\n\t\t\t\tparentHeight={ parentHeight }\n\t\t\t>\n\t\t\t\t<ScrollView style={ styles.scrollView }>\n\t\t\t\t\t<TextInput\n\t\t\t\t\t\tautoCorrect={ false }\n\t\t\t\t\t\taccessibilityLabel=\"html-view-title\"\n\t\t\t\t\t\ttextAlignVertical=\"center\"\n\t\t\t\t\t\tnumberOfLines={ 1 }\n\t\t\t\t\t\tstyle={ titleStyle }\n\t\t\t\t\t\tvalue={ title }\n\t\t\t\t\t\tplaceholder={ __( 'Add title' ) }\n\t\t\t\t\t\tplaceholderTextColor={ placeholderStyle.color }\n\t\t\t\t\t\tonChangeText={ editTitle }\n\t\t\t\t\t/>\n\t\t\t\t\t<TextInput\n\t\t\t\t\t\tref={ this.contentTextInputRef }\n\t\t\t\t\t\tautoCorrect={ false }\n\t\t\t\t\t\taccessibilityLabel=\"html-view-content\"\n\t\t\t\t\t\ttextAlignVertical=\"top\"\n\t\t\t\t\t\tmultiline\n\t\t\t\t\t\tstyle={ htmlStyle }\n\t\t\t\t\t\tvalue={ this.state.value }\n\t\t\t\t\t\tonChangeText={ this.edit }\n\t\t\t\t\t\tonBlur={ this.stopEditing }\n\t\t\t\t\t\tplaceholder={ __( 'Start writingâ€¦' ) }\n\t\t\t\t\t\tplaceholderTextColor={ placeholderStyle.color }\n\t\t\t\t\t\tscrollEnabled={ false }\n\t\t\t\t\t\t// [Only iOS] This prop prevents the text input from\n\t\t\t\t\t\t// automatically getting focused after scrolling\n\t\t\t\t\t\t// content.\n\t\t\t\t\t\trejectResponderTermination={ false }\n\t\t\t\t\t/>\n\t\t\t\t</ScrollView>\n\t\t\t</KeyboardAvoidingView>\n\t\t);\n\t}\n}\n\nexport default compose( [\n\twithSelect( ( select ) => {\n\t\tconst { getEditedPostAttribute, getEditedPostContent } =\n\t\t\tselect( 'core/editor' );\n\n\t\treturn {\n\t\t\ttitle: getEditedPostAttribute( 'title' ),\n\t\t\tvalue: getEditedPostContent(),\n\t\t};\n\t} ),\n\twithDispatch( ( dispatch ) => {\n\t\tconst { editPost, resetEditorBlocks } = dispatch( 'core/editor' );\n\t\treturn {\n\t\t\teditTitle( title ) {\n\t\t\t\teditPost( { title } );\n\t\t\t},\n\t\t\tonChange( content ) {\n\t\t\t\teditPost( { content } );\n\t\t\t},\n\t\t\tonPersist( content ) {\n\t\t\t\tconst blocks = parse( content );\n\t\t\t\tresetEditorBlocks( blocks );\n\t\t\t},\n\t\t};\n\t} ),\n\twithInstanceId,\n\twithPreferredColorScheme,\n] )( HTMLTextInput );\n"],"mappings":"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"}